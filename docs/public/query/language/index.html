<!doctype html>
<html itemscope itemtype="http://schema.org/WebPage" lang="en" class="no-js">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="noindex, nofollow">


<link rel="shortcut icon" href="/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/favicons/android-192x192.png" sizes="192x192">

<title>The Bazel Query Reference | Bazel Documentation</title>
<meta name="description" content="This page is the reference manual for the Bazel Query Language used when you use bazel query to analyze build dependencies. It also describes the output formats bazel query supports.
For practical use cases, see the Bazel Query How-To.
Additional query reference In addition to query, which runs on the post-loading phase target graph, Bazel includes action graph query and configurable query.
Action graph query The action graph query (aquery) operates on the post-analysis Configured Target Graph and exposes information about Actions, Artifacts, and their relationships. aquery is useful when you are interested in the properties of the Actions/Artifacts generated from the Configured Target Graph. For example, the actual commands run and their inputs, outputs, and mnemonics.">
<meta property="og:url" content="http://localhost:1313/query/language/">
  <meta property="og:site_name" content="Bazel Documentation">
  <meta property="og:title" content="The Bazel Query Reference">
  <meta property="og:description" content="This page is the reference manual for the Bazel Query Language used when you use bazel query to analyze build dependencies. It also describes the output formats bazel query supports.
For practical use cases, see the Bazel Query How-To.
Additional query reference In addition to query, which runs on the post-loading phase target graph, Bazel includes action graph query and configurable query.
Action graph query The action graph query (aquery) operates on the post-analysis Configured Target Graph and exposes information about Actions, Artifacts, and their relationships. aquery is useful when you are interested in the properties of the Actions/Artifacts generated from the Configured Target Graph. For example, the actual commands run and their inputs, outputs, and mnemonics.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="query">
    <meta property="article:published_time" content="2024-01-01T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-01-01T00:00:00+00:00">

  <meta itemprop="name" content="The Bazel Query Reference">
  <meta itemprop="description" content="This page is the reference manual for the Bazel Query Language used when you use bazel query to analyze build dependencies. It also describes the output formats bazel query supports.
For practical use cases, see the Bazel Query How-To.
Additional query reference In addition to query, which runs on the post-loading phase target graph, Bazel includes action graph query and configurable query.
Action graph query The action graph query (aquery) operates on the post-analysis Configured Target Graph and exposes information about Actions, Artifacts, and their relationships. aquery is useful when you are interested in the properties of the Actions/Artifacts generated from the Configured Target Graph. For example, the actual commands run and their inputs, outputs, and mnemonics.">
  <meta itemprop="datePublished" content="2024-01-01T00:00:00+00:00">
  <meta itemprop="dateModified" content="2024-01-01T00:00:00+00:00">
  <meta itemprop="wordCount" content="8425">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="The Bazel Query Reference">
  <meta name="twitter:description" content="This page is the reference manual for the Bazel Query Language used when you use bazel query to analyze build dependencies. It also describes the output formats bazel query supports.
For practical use cases, see the Bazel Query How-To.
Additional query reference In addition to query, which runs on the post-loading phase target graph, Bazel includes action graph query and configurable query.
Action graph query The action graph query (aquery) operates on the post-analysis Configured Target Graph and exposes information about Actions, Artifacts, and their relationships. aquery is useful when you are interested in the properties of the Actions/Artifacts generated from the Configured Target Graph. For example, the actual commands run and their inputs, outputs, and mnemonics.">
<link href="/scss/main.css" rel="stylesheet">
<script
  src="https://code.jquery.com/jquery-3.7.1.min.js"
  integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g=="
  crossorigin="anonymous"></script>

  </head>
  <body class="td-page">
    <header>
      <nav class="td-navbar js-navbar-scroll" data-bs-theme="dark">
<div class="container-fluid flex-column flex-md-row">
  <a class="navbar-brand" href="/"><span class="navbar-brand__logo navbar-logo"><svg id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 500 500" style="enable-background:new 0 0 500 500"><g><path style="fill:#fff" d="M116.8525 421.9722c-5.7041.0-10.3442-4.3127-10.3442-9.6129V88.183c0-5.3002 4.6401-9.6117 10.3442-9.6117H320.858c3.0347.0 9.3959.5498 11.7506 2.6302l.3545.3442 58.905 63.2912c2.3101 2.491 2.9202 8.4928 2.9202 11.3184v256.2039c0 5.3002-4.6407 9.6129-10.3436 9.6129H116.8525z"/><g><g><g><path style="fill:#767676" d="M384.4445 423.2066H116.852c-6.3839.0-11.5786-4.8658-11.5786-10.8474V88.1831c0-5.9804 5.1947-10.8461 11.5786-10.8461h204.0062c.377.0 9.2786.0329 12.568 2.9389l.3947.3833 58.9508 63.337c3.2135 3.4652 3.2514 11.7924 3.2514 12.1593v256.2036C396.0231 418.3408 390.8284 423.2066 384.4445 423.2066zM116.5079 411.9189c.0848.0278.1999.0531.3441.0531h267.5925c.1442.0.2581-.0253.3441-.0531V156.1556c-.0076-.9033-.3593-3.7347-.7034-5.0037l-57.6527-61.9416c-1.4651-.3176-4.4533-.6389-5.5742-.6389H116.852c-.143.0-.2594.024-.3441.0531V411.9189zm267.4533-261.149zM327.0321 89.371v.0013V89.371z"/></g></g></g><g><g><path style="fill:#5b7fc0" d="M189.0874 210.1754l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.025 2.454-11.4897 6.4116-15.4473C177.5953 212.627 183.0601 210.1742 189.0874 210.1754zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403S197.0816 234.1722 197.0804 232.033z"/><path style="opacity:.3;fill:#fff" d="M189.0898 210.176c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 212.6276 183.0612 210.176 189.0898 210.176zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 236.239 197.0839 234.2399 197.0839 232.0372z"/><g><defs><path id="SVGID_1_" d="M194.7376 237.6875c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.999 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 234.2399 196.1861 236.239 194.7376 237.6875z"/></defs><clipPath id="SVGID_2_"><use xlink:href="#SVGID_1_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_2_);fill:#fff" d="M190.0704 225.0237c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 225.7247 191.9774 225.0237 190.0704 225.0237z"/><path style="opacity:.13;clip-path:url(#SVGID_2_);fill:#020202" d="M190.0704 225.0237c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 225.7247 191.9774 225.0237 190.0704 225.0237z"/></g><g><defs><path id="SVGID_3_" d="M189.0898 210.176c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 212.6276 183.0612 210.176 189.0898 210.176zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 236.239 197.0839 234.2399 197.0839 232.0372z"/></defs><clipPath id="SVGID_4_"><use xlink:href="#SVGID_3_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_4_);fill:#5b7fc0" d="M172.6595 215.6045c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8612 12.0547.0024 21.8636-9.797 21.8613-21.8612.0024-3.8475-1.0151-7.6326-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 209.1953 176.6171 211.647 172.6595 215.6045z"/></g></g><rect x="198.8952" y="225.1043" style="fill:#5b7fc0" width="122.6266" height="13.8671"/></g><g><path style="fill:#d95140" d="M189.0874 155.7611l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.0249 2.454-11.4897 6.4116-15.4473C177.5953 158.2128 183.0601 155.7599 189.0874 155.7611zm7.993 21.8577c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403C196.2508 181.7667 197.0816 179.758 197.0804 177.6188z"/><path style="opacity:.3;fill:#fff" d="M189.0898 155.7617c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 158.2134 183.0612 155.7617 189.0898 155.7617zm7.9941 21.8613c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 181.8248 197.0839 179.8256 197.0839 177.623z"/><g><defs><path id="SVGID_5_" d="M194.7376 183.2733c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.9989 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 179.8256 196.1861 181.8248 194.7376 183.2733z"/></defs><clipPath id="SVGID_6_"><use xlink:href="#SVGID_5_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_6_);fill:#fff" d="M190.0704 170.6095c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 171.3104 191.9774 170.6095 190.0704 170.6095z"/><path style="opacity:.13;clip-path:url(#SVGID_6_);fill:#020202" d="M190.0704 170.6095c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 171.3104 191.9774 170.6095 190.0704 170.6095z"/></g><g><defs><path id="SVGID_7_" d="M189.0898 155.7617c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 158.2134 183.0612 155.7617 189.0898 155.7617zm7.9941 21.8613c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 181.8248 197.0839 179.8256 197.0839 177.623z"/></defs><clipPath id="SVGID_8_"><use xlink:href="#SVGID_7_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_8_);fill:#d95140" d="M172.6595 161.1903c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8613 12.0547.0024 21.8636-9.797 21.8613-21.8613.0024-3.8474-1.0151-7.6326-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 154.7811 176.6171 157.2327 172.6595 161.1903z"/></g><rect x="198.8952" y="170.69" style="fill:#d95140" width="122.6266" height="13.8671"/></g><g><g><path style="fill:#56a55c" d="M189.5379 264.6147l.0012-.0012c7.7751.0012 15.0294 4.1862 18.932 10.9235 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032-5.8394.0-11.3281-2.2733-15.458-6.4032-4.13-4.13-6.4032-9.6186-6.4056-15.4628.0012-6.0249 2.454-11.4897 6.4116-15.4472C178.0458 267.0663 183.5105 264.6135 189.5379 264.6147zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6538 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403C196.7013 290.6202 197.5321 288.6115 197.5309 286.4723z"/><path style="opacity:.3;fill:#fff" d="M189.5403 264.6153c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8065-21.8612-21.8613.0-6.0285 2.4516-11.492 6.4116-15.452C178.0482 267.0669 183.5117 264.6153 189.5403 264.6153zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.6366 290.6783 197.5344 288.6792 197.5344 286.4765z"/><g><defs><path id="SVGID_9_" d="M195.1881 292.1268c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.9989 7.9942-7.9941 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.5344 288.6792 196.6366 290.6783 195.1881 292.1268z"/></defs><clipPath id="SVGID_10_"><use xlink:href="#SVGID_9_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_10_);fill:#fff" d="M190.5209 279.463c-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7446-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9941 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C194.239 280.164 192.4279 279.463 190.5209 279.463z"/><path style="opacity:.13;clip-path:url(#SVGID_10_);fill:#020202" d="M190.5209 279.463c-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7446-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9941 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C194.239 280.164 192.4279 279.463 190.5209 279.463z"/></g><g><defs><path id="SVGID_11_" d="M189.5403 264.6153c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8065-21.8612-21.8613.0-6.0285 2.4516-11.492 6.4116-15.452C178.0482 267.0669 183.5117 264.6153 189.5403 264.6153zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.6366 290.6783 197.5344 288.6792 197.5344 286.4765z"/></defs><clipPath id="SVGID_12_"><use xlink:href="#SVGID_11_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_12_);fill:#56a55c" d="M173.11 270.0439c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8613 12.0547.0024 21.8636-9.797 21.8613-21.8613.0024-3.8474-1.0151-7.6326-2.9353-10.9462-3.8977-6.7325-11.1497-10.9151-18.926-10.9151C182.5311 263.6346 177.0676 266.0863 173.11 270.0439z"/></g></g><rect x="199.3456" y="279.5436" style="fill:#56a55c" width="122.6266" height="13.8671"/></g><g><g><path style="fill:#f1bc42" d="M189.0874 318.7208l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3305-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.025 2.454-11.4897 6.4116-15.4472C177.5953 321.1724 183.0601 318.7196 189.0874 318.7208zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403S197.0816 342.7176 197.0804 340.5784z"/><path style="opacity:.3;fill:#fff" d="M189.0898 318.7214c7.7763.0 15.0283 4.1826 18.926 10.915 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8612-12.0547.0024-21.8636-9.8065-21.8612-21.8612.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 321.173 183.0612 318.7214 189.0898 318.7214zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 344.7844 197.0839 342.7853 197.0839 340.5826z"/><g><defs><path id="SVGID_13_" d="M194.7376 346.2329c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.999 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 342.7853 196.1861 344.7844 194.7376 346.2329z"/></defs><clipPath id="SVGID_14_"><use xlink:href="#SVGID_13_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_14_);fill:#fff" d="M190.0704 333.5691c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0834 6.1218 2.8788C193.7885 334.2701 191.9774 333.5691 190.0704 333.5691z"/><path style="opacity:.13;clip-path:url(#SVGID_14_);fill:#020202" d="M190.0704 333.5691c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0834 6.1218 2.8788C193.7885 334.2701 191.9774 333.5691 190.0704 333.5691z"/></g><g><defs><path id="SVGID_15_" d="M189.0898 318.7214c7.7763.0 15.0283 4.1826 18.926 10.915 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8612-12.0547.0024-21.8636-9.8065-21.8612-21.8612.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 321.173 183.0612 318.7214 189.0898 318.7214zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 344.7844 197.0839 342.7853 197.0839 340.5826z"/></defs><clipPath id="SVGID_16_"><use xlink:href="#SVGID_15_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_16_);fill:#f1bc42" d="M172.6595 324.15c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8612 12.0547.0024 21.8636-9.797 21.8613-21.8612.0024-3.8474-1.0151-7.6327-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 317.7407 176.6171 320.1924 172.6595 324.15z"/></g></g><rect x="198.8952" y="333.6497" style="fill:#f1bc42" width="122.6266" height="13.8671"/></g></g></svg></span><span class="navbar-brand__name">Bazel Documentation</span></a>
  <div class="td-navbar-nav-scroll ms-md-auto" id="main_navbar">
    <ul class="navbar-nav">
      <li class="nav-item">
        <a class="nav-link" href="/docs/"><span>Documentation</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/community/"><span>Community</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/about/"><span>About</span></a>
      </li>
      </ul>
  </div>
  <div class="d-none d-lg-block">
    
  </div>
</div>
</nav>
    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
            <div id="td-sidebar-menu" class="td-sidebar__inner">
  <form class="td-sidebar__search d-flex align-items-center">
    
    <button class="btn btn-link td-sidebar__toggle d-md-none p-0 ms-3 fas fa-bars" type="button" data-bs-toggle="collapse" data-bs-target="#td-section-nav" aria-controls="td-section-nav" aria-expanded="false" aria-label="Toggle section navigation">
    </button>
  </form>
  <nav class="td-sidebar-nav collapse" id="td-section-nav">
    <ul class="td-sidebar-nav__section pe-md-3 ul-0">
      <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id="m--li">
  <a href="/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section tree-root" id="m-"><span class="">Bazel Documentation</span></a>
  <ul class="ul-1">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-help-li">
  <a href="/help/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-help"><span class="">Getting Help</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-concepts-li">
  <a href="/concepts/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-concepts"><span class="">Understanding Bazel</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-conceptsbuild-files-li">
  <a href="/concepts/build-files/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-conceptsbuild-files"><span class="">BUILD files</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-conceptsdependencies-li">
  <a href="/concepts/dependencies/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-conceptsdependencies"><span class="">Dependencies</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-conceptslabels-li">
  <a href="/concepts/labels/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-conceptslabels"><span class="">Labels</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-conceptsplatforms-li">
  <a href="/concepts/platforms/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-conceptsplatforms"><span class="">Migrating to Platforms</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-conceptsbuild-ref-li">
  <a href="/concepts/build-ref/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-conceptsbuild-ref"><span class="">Repositories, workspaces, packages, and targets</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-conceptsvisibility-li">
  <a href="/concepts/visibility/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-conceptsvisibility"><span class="">Visibility</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-basics-li">
  <a href="/basics/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-basics"><span class="">Basics</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-basicsartifact-based-builds-li">
  <a href="/basics/artifact-based-builds/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-basicsartifact-based-builds"><span class="">Artifact-Based Build Systems</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-basicsdependencies-li">
  <a href="/basics/dependencies/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-basicsdependencies"><span class="">Dependency Management</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-basicsdistributed-builds-li">
  <a href="/basics/distributed-builds/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-basicsdistributed-builds"><span class="">Distributed Builds</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-basicshermeticity-li">
  <a href="/basics/hermeticity/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-basicshermeticity"><span class="">Hermeticity</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-basicstask-based-builds-li">
  <a href="/basics/task-based-builds/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-basicstask-based-builds"><span class="">Task-Based Build Systems</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-basicsbuild-systems-li">
  <a href="/basics/build-systems/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-basicsbuild-systems"><span class="">Why a Build System?</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-tutorials-li">
  <a href="/tutorials/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-tutorials"><span class="">Tutorials</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-tutorialsccp-toolchain-config-li">
  <a href="/tutorials/ccp-toolchain-config/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-tutorialsccp-toolchain-config"><span class="">Bazel Tutorial: Configure C&#43;&#43; Toolchains</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-tutorialscpp-use-cases-li">
  <a href="/tutorials/cpp-use-cases/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-tutorialscpp-use-cases"><span class="">Common C&#43;&#43; Build Use Cases</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-tutorialscpp-dependency-li">
  <a href="/tutorials/cpp-dependency/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-tutorialscpp-dependency"><span class="">Review the dependency graph</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-tutorialscpp-labels-li">
  <a href="/tutorials/cpp-labels/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-tutorialscpp-labels"><span class="">Use labels to reference targets</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-configure-li">
  <a href="/configure/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-configure"><span class="">Configure</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-configurebest-practices-li">
  <a href="/configure/best-practices/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-configurebest-practices"><span class="">Best Practices</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-configurecoverage-li">
  <a href="/configure/coverage/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-configurecoverage"><span class="">Code coverage with Bazel</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-configureattributes-li">
  <a href="/configure/attributes/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-configureattributes"><span class="">Configurable Build Attributes</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-configureintegrate-cpp-li">
  <a href="/configure/integrate-cpp/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-configureintegrate-cpp"><span class="">Integrating with C&#43;&#43; Rules</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-configurewindows-li">
  <a href="/configure/windows/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-configurewindows"><span class="">Using Bazel on Windows</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-extending-li">
  <a href="/extending/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-extending"><span class="">Extending Bazel</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-extendingaspects-li">
  <a href="/extending/aspects/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-extendingaspects"><span class="">Aspects</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-extendingauto-exec-groups-li">
  <a href="/extending/auto-exec-groups/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-extendingauto-exec-groups"><span class="">Automatic Execution Groups (AEGs)</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-extendingconfig-li">
  <a href="/extending/config/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-extendingconfig"><span class="">Configurations</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-extendingdepsets-li">
  <a href="/extending/depsets/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-extendingdepsets"><span class="">Depsets</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-extendingexec-groups-li">
  <a href="/extending/exec-groups/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-extendingexec-groups"><span class="">Execution Groups</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-extendingconcepts-li">
  <a href="/extending/concepts/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-extendingconcepts"><span class="">Extension Overview</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-extendinglegacy-macros-li">
  <a href="/extending/legacy-macros/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-extendinglegacy-macros"><span class="">Legacy Macros</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-extendingmacros-li">
  <a href="/extending/macros/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-extendingmacros"><span class="">Macros</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-extendingplatforms-li">
  <a href="/extending/platforms/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-extendingplatforms"><span class="">Platforms</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-extendingrules-li">
  <a href="/extending/rules/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-extendingrules"><span class="">Rules</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-extendingtoolchains-li">
  <a href="/extending/toolchains/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-extendingtoolchains"><span class="">Toolchains</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-external-li">
  <a href="/external/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-external"><span class="">External</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-externalmod-command-li">
  <a href="/external/mod-command/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-externalmod-command"><span class="">`mod` Command</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-externallockfile-li">
  <a href="/external/lockfile/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-externallockfile"><span class="">Bazel Lockfile</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-externalmodule-li">
  <a href="/external/module/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-externalmodule"><span class="">Bazel modules</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-externalregistry-li">
  <a href="/external/registry/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-externalregistry"><span class="">Bazel registries</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-externalmigration-li">
  <a href="/external/migration/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-externalmigration"><span class="">Bzlmod Migration Guide</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-externaloverview-li">
  <a href="/external/overview/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-externaloverview"><span class="">External dependencies overview</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-externalfaq-li">
  <a href="/external/faq/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-externalfaq"><span class="">Frequently asked questions</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-externalextension-li">
  <a href="/external/extension/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-externalextension"><span class="">Module extensions</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-externalrepo-li">
  <a href="/external/repo/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-externalrepo"><span class="">Repository Rules</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-externalvendor-li">
  <a href="/external/vendor/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-externalvendor"><span class="">Vendor Mode</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-externalimages-li">
  <a href="/external/images/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-externalimages"><span class="">Images</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-remote-li">
  <a href="/remote/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-remote"><span class="">Remote</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-remoterules-li">
  <a href="/remote/rules/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-remoterules"><span class="">Adapting Bazel Rules for Remote Execution</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-remotebep-li">
  <a href="/remote/bep/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-remotebep"><span class="">Build Event Protocol</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-remotebep-examples-li">
  <a href="/remote/bep-examples/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-remotebep-examples"><span class="">Build Event Protocol Examples</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-remotebep-glossary-li">
  <a href="/remote/bep-glossary/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-remotebep-glossary"><span class="">Build Event Protocol Glossary</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-remoteci-li">
  <a href="/remote/ci/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-remoteci"><span class="">Configuring Bazel CI to Test Rules for Remote Execution</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-remotecreating-li">
  <a href="/remote/creating/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-remotecreating"><span class="">Creating Persistent Workers</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-remotecache-local-li">
  <a href="/remote/cache-local/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-remotecache-local"><span class="">Debugging Remote Cache Hits for Local Execution</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-remotecache-remote-li">
  <a href="/remote/cache-remote/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-remotecache-remote"><span class="">Debugging Remote Cache Hits for Remote Execution</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-remotedynamic-li">
  <a href="/remote/dynamic/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-remotedynamic"><span class="">Dynamic Execution</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-remoteworkspace-li">
  <a href="/remote/workspace/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-remoteworkspace"><span class="">Finding Non-Hermetic Behavior in WORKSPACE Rules</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-remotemultiplex-li">
  <a href="/remote/multiplex/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-remotemultiplex"><span class="">Multiplex Workers (Experimental Feature)</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-remoteoutput-directories-li">
  <a href="/remote/output-directories/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-remoteoutput-directories"><span class="">Output Directory Layout</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-remotepersistent-li">
  <a href="/remote/persistent/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-remotepersistent"><span class="">Persistent Workers</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-remotecaching-li">
  <a href="/remote/caching/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-remotecaching"><span class="">Remote Caching</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-remoterbe-li">
  <a href="/remote/rbe/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-remoterbe"><span class="">Remote Execution Overview</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-remotesandbox-li">
  <a href="/remote/sandbox/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-remotesandbox"><span class="">Troubleshooting Bazel Remote Execution with Docker Sandbox</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id="m-query-li">
  <a href="/query/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-query"><span class="">Query</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-queryaquery-li">
  <a href="/query/aquery/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-queryaquery"><span class="">Action Graph Query (aquery)</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-querycquery-li">
  <a href="/query/cquery/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-querycquery"><span class="">Configurable Query (cquery)</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-queryguide-li">
  <a href="/query/guide/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-queryguide"><span class="">Query guide</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-queryquickstart-li">
  <a href="/query/quickstart/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-queryquickstart"><span class="">Query quickstart</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id="m-querylanguage-li">
  <a href="/query/language/" class="align-left ps-0 active td-sidebar-link td-sidebar-link__page" id="m-querylanguage"><span class="td-sidebar-nav-active-item">The Bazel Query Reference</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-queryimages-li">
  <a href="/query/images/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-queryimages"><span class="">Images</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-advanced-li">
  <a href="/advanced/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-advanced"><span class="">Advanced</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-advancedperformance-li">
  <a href="/advanced/performance/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-advancedperformance"><span class="">Performance</span></a>
  <ul class="ul-3 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-advancedperformancebuild-performance-breakdown-li">
  <a href="/advanced/performance/build-performance-breakdown/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-advancedperformancebuild-performance-breakdown"><span class="">Breaking down build performance</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-advancedperformancebuild-performance-metrics-li">
  <a href="/advanced/performance/build-performance-metrics/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-advancedperformancebuild-performance-metrics"><span class="">Extracting build performance metrics</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-advancedperformancejson-trace-profile-li">
  <a href="/advanced/performance/json-trace-profile/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-advancedperformancejson-trace-profile"><span class="">JSON Trace Profile</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-advancedperformanceiteration-speed-li">
  <a href="/advanced/performance/iteration-speed/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-advancedperformanceiteration-speed"><span class="">Optimize Iteration Speed</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-advancedperformancememory-li">
  <a href="/advanced/performance/memory/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-advancedperformancememory"><span class="">Optimize Memory</span></a>
</li>
  </ul>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-install-li">
  <a href="/install/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-install"><span class="">Install</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-installcompletion-li">
  <a href="/install/completion/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-installcompletion"><span class="">Command-Line Completion</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-installcompile-source-li">
  <a href="/install/compile-source/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-installcompile-source"><span class="">Compiling Bazel from Source</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-installdocker-container-li">
  <a href="/install/docker-container/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-installdocker-container"><span class="">Getting Started with Bazel Docker Container</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-installbazelisk-li">
  <a href="/install/bazelisk/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-installbazelisk"><span class="">Installing / Updating Bazel using Bazelisk</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-installos-x-li">
  <a href="/install/os-x/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-installos-x"><span class="">Installing Bazel on macOS</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-installsuse-li">
  <a href="/install/suse/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-installsuse"><span class="">Installing Bazel on openSUSE Tumbleweed &amp; Leap</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-installubuntu-li">
  <a href="/install/ubuntu/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-installubuntu"><span class="">Installing Bazel on Ubuntu</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-installwindows-li">
  <a href="/install/windows/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-installwindows"><span class="">Installing Bazel on Windows</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-installide-li">
  <a href="/install/ide/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-installide"><span class="">Integrating Bazel with IDEs</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-installimages-li">
  <a href="/install/images/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-installimages"><span class="">Images</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-migrate-li">
  <a href="/migrate/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-migrate"><span class="">Migrate</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-migratemaven-li">
  <a href="/migrate/maven/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-migratemaven"><span class="">Migrating from Maven to Bazel</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-migratexcode-li">
  <a href="/migrate/xcode/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-migratexcode"><span class="">Migrating from Xcode to Bazel</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-reference-li">
  <a href="/reference/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-reference"><span class="">Reference</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-referenceflag-cheatsheet-li">
  <a href="/reference/flag-cheatsheet/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-referenceflag-cheatsheet"><span class="">Bazel flag cheat sheet</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-referenceglossary-li">
  <a href="/reference/glossary/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-referenceglossary"><span class="">Bazel Glossary</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-referenceskyframe-li">
  <a href="/reference/skyframe/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-referenceskyframe"><span class="">Skyframe</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-referencetest-encyclopedia-li">
  <a href="/reference/test-encyclopedia/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-referencetest-encyclopedia"><span class="">Test encyclopedia</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-release-li">
  <a href="/release/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-release"><span class="">Release</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-releasebackward-compatibility-li">
  <a href="/release/backward-compatibility/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-releasebackward-compatibility"><span class="">Backward Compatibility</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-releaserolling-li">
  <a href="/release/rolling/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-releaserolling"><span class="">Rolling Releases</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-releaserule-compatibility-li">
  <a href="/release/rule-compatibility/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-releaserule-compatibility"><span class="">Rule Compatibility</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-rules-li">
  <a href="/rules/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-rules"><span class="">Rules</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-rulesbzl-style-li">
  <a href="/rules/bzl-style/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-rulesbzl-style"><span class="">.bzl style guide</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-ruleschallenges-li">
  <a href="/rules/challenges/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-ruleschallenges"><span class="">Challenges of Writing Rules</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-ruleslegacy-macro-tutorial-li">
  <a href="/rules/legacy-macro-tutorial/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-ruleslegacy-macro-tutorial"><span class="">Creating a Legacy Macro</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-rulesmacro-tutorial-li">
  <a href="/rules/macro-tutorial/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-rulesmacro-tutorial"><span class="">Creating a Symbolic Macro</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-rulesdeploying-li">
  <a href="/rules/deploying/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-rulesdeploying"><span class="">Deploying Rules</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-ruleserrors-li">
  <a href="/rules/errors/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-ruleserrors"><span class="">Errors</span></a>
  <ul class="ul-3 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-ruleserrorsread-only-variable-li">
  <a href="/rules/errors/read-only-variable/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-ruleserrorsread-only-variable"><span class="">Error: Variable x is read only</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-rulesfaq-li">
  <a href="/rules/faq/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-rulesfaq"><span class="">Frequently Asked Questions</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-rulesperformance-li">
  <a href="/rules/performance/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-rulesperformance"><span class="">Optimizing Performance</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-rulesrules-tutorial-li">
  <a href="/rules/rules-tutorial/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-rulesrules-tutorial"><span class="">Rules Tutorial</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-ruleslanguage-li">
  <a href="/rules/language/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-ruleslanguage"><span class="">Starlark Language</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-rulestesting-li">
  <a href="/rules/testing/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-rulestesting"><span class="">Testing</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-rulesverbs-tutorial-li">
  <a href="/rules/verbs-tutorial/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-rulesverbs-tutorial"><span class="">Using Macros to Create Custom Verbs</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-ruleswindows-li">
  <a href="/rules/windows/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-ruleswindows"><span class="">Writing Rules on Windows</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-run-li">
  <a href="/run/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-run"><span class="">Run</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-runbuild-li">
  <a href="/run/build/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-runbuild"><span class="">Build programs with Bazel</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-runscripts-li">
  <a href="/run/scripts/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-runscripts"><span class="">Calling Bazel from scripts</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-runclient-server-li">
  <a href="/run/client-server/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-runclient-server"><span class="">Client/server implementation</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-runbazelrc-li">
  <a href="/run/bazelrc/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-runbazelrc"><span class="">Write bazelrc configuration files</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-start-li">
  <a href="/start/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-start"><span class="">Start</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-startcpp-li">
  <a href="/start/cpp/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-startcpp"><span class="">Bazel Tutorial: Build a C&#43;&#43; Project</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-startgo-li">
  <a href="/start/go/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-startgo"><span class="">Bazel Tutorial: Build a Go Project</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-startjava-li">
  <a href="/start/java/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-startjava"><span class="">Bazel Tutorial: Build a Java Project</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-startandroid-app-li">
  <a href="/start/android-app/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-startandroid-app"><span class="">Bazel Tutorial: Build an Android App</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-startios-app-li">
  <a href="/start/ios-app/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-startios-app"><span class="">Bazel Tutorial: Build an iOS App</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-docs-li">
  <a href="/docs/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-docs"><span class="">Using Bazel</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsbazel-and-android-li">
  <a href="/docs/bazel-and-android/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsbazel-and-android"><span class="">Android and Bazel</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsandroid-build-performance-li">
  <a href="/docs/android-build-performance/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsandroid-build-performance"><span class="">Android Build Performance</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsandroid-instrumentation-test-li">
  <a href="/docs/android-instrumentation-test/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsandroid-instrumentation-test"><span class="">Android Instrumentation Tests</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsbazel-and-apple-li">
  <a href="/docs/bazel-and-apple/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsbazel-and-apple"><span class="">Apple Apps and Bazel</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsmobile-install-li">
  <a href="/docs/mobile-install/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsmobile-install"><span class="">bazel mobile-install</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsbazel-and-cpp-li">
  <a href="/docs/bazel-and-cpp/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsbazel-and-cpp"><span class="">C&#43;&#43; and Bazel</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docscc-toolchain-config-reference-li">
  <a href="/docs/cc-toolchain-config-reference/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docscc-toolchain-config-reference"><span class="">C&#43;&#43; Toolchain Configuration</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsuser-manual-li">
  <a href="/docs/user-manual/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsuser-manual"><span class="">Commands and Options</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsconfigurable-attributes-li">
  <a href="/docs/configurable-attributes/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsconfigurable-attributes"><span class="">Configurable Build Attributes</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsbazel-and-java-li">
  <a href="/docs/bazel-and-java/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsbazel-and-java"><span class="">Java and Bazel</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsbazel-and-javascript-li">
  <a href="/docs/bazel-and-javascript/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsbazel-and-javascript"><span class="">JavaScript and Bazel</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docssandboxing-li">
  <a href="/docs/sandboxing/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docssandboxing"><span class="">Sandboxing</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsandroid-ndk-li">
  <a href="/docs/android-ndk/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docsandroid-ndk"><span class="">Using the Android Native Development Kit with Bazel</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsimages-li">
  <a href="/docs/images/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-docsimages"><span class="">Images</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-brand-li">
  <a href="/brand/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-brand"><span class="">Brand</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-images-li">
  <a href="/images/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-images"><span class="">Images</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-versions-li">
  <a href="/versions/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-versions"><span class="">Versions</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-community-li">
  <a href="/community/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-community"><span class="">Community &amp; Product Partners</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-communityroadmaps-configurability-li">
  <a href="/community/roadmaps-configurability/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-communityroadmaps-configurability"><span class="">Bazel Configurability 2021 Roadmap</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-communitysig-li">
  <a href="/community/sig/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-communitysig"><span class="">Bazel Special Interest Groups</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-communityupdate-li">
  <a href="/community/update/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-communityupdate"><span class="">Community updates</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-communityrecommended-rules-li">
  <a href="/community/recommended-rules/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-communityrecommended-rules"><span class="">Recommended Rules</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-communityremote-execution-services-li">
  <a href="/community/remote-execution-services/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-communityremote-execution-services"><span class="">Remote Execution Services</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-communityroadmaps-starlark-li">
  <a href="/community/roadmaps-starlark/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-communityroadmaps-starlark"><span class="">Starlark Roadmap</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-communityusers-li">
  <a href="/community/users/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-communityusers"><span class="">Who&#39;s Using Bazel</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-communityexperts-li">
  <a href="/community/experts/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-communityexperts"><span class="">Experts</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-communityimages-li">
  <a href="/community/images/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-communityimages"><span class="">Images</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-communitypartners-li">
  <a href="/community/partners/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-communitypartners"><span class="">Partners</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-contribute-li">
  <a href="/contribute/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-contribute"><span class="">Contribute</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-contributestatemachine-guide-li">
  <a href="/contribute/statemachine-guide/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-contributestatemachine-guide"><span class="">A Guide to Skyframe `StateMachine`s</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-contributedocs-style-guide-li">
  <a href="/contribute/docs-style-guide/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-contributedocs-style-guide"><span class="">Bazel docs style guide</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-contributedocs-li">
  <a href="/contribute/docs/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-contributedocs"><span class="">Contribute to Bazel documentation</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-contributepolicy-li">
  <a href="/contribute/policy/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-contributepolicy"><span class="">Contribution policy</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-contributedesign-documents-li">
  <a href="/contribute/design-documents/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-contributedesign-documents"><span class="">Design Documents</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-contributemaintainers-guide-li">
  <a href="/contribute/maintainers-guide/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-contributemaintainers-guide"><span class="">Guide for Bazel Maintainers</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-contributebreaking-changes-li">
  <a href="/contribute/breaking-changes/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-contributebreaking-changes"><span class="">Guide for rolling out breaking changes</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-contributewindows-chocolatey-maintenance-li">
  <a href="/contribute/windows-chocolatey-maintenance/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-contributewindows-chocolatey-maintenance"><span class="">Maintaining Bazel Chocolatey package on Windows</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-contributewindows-scoop-maintenance-li">
  <a href="/contribute/windows-scoop-maintenance/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-contributewindows-scoop-maintenance"><span class="">Maintaining Bazel Scoop package on Windows</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-contributenaming-li">
  <a href="/contribute/naming/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-contributenaming"><span class="">Naming a Bazel related project</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-contributepatch-acceptance-li">
  <a href="/contribute/patch-acceptance/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-contributepatch-acceptance"><span class="">Patch Acceptance Process</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-contributesearch-li">
  <a href="/contribute/search/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-contributesearch"><span class="">Searching the codebase</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-contributecodebase-li">
  <a href="/contribute/codebase/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-contributecodebase"><span class="">The Bazel codebase</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-contributerelease-notes-li">
  <a href="/contribute/release-notes/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-contributerelease-notes"><span class="">Writing release notes</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-contributeimages-li">
  <a href="/contribute/images/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-contributeimages"><span class="">Images</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-about-li">
  <a href="/about/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id="m-about"><span class="">About</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-aboutroadmap-li">
  <a href="/about/roadmap/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-aboutroadmap"><span class="">Bazel roadmap</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-aboutvision-li">
  <a href="/about/vision/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-aboutvision"><span class="">Bazel Vision</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-aboutfaq-li">
  <a href="/about/faq/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-aboutfaq"><span class="">FAQ</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-aboutintro-li">
  <a href="/about/intro/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-aboutintro"><span class="">Intro to Bazel</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-aboutwhy-li">
  <a href="/about/why/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-aboutwhy"><span class="">Why Bazel?</span></a>
</li>
  </ul>
</li>
  </ul>
</li>
    </ul>
  </nav>
</div>

          </aside>
          <aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none">
            <div class="td-page-meta ms-2 pb-1 pt-2 mb-0">
<a href="https://github.com/bazelbuild/bazel/tree/master/site/en/content/query/language.md" class="td-page-meta--view td-page-meta__view" target="_blank" rel="noopener"><i class="fa-solid fa-file-lines fa-fw"></i> View page source</a>
  <a href="https://github.com/bazelbuild/bazel/edit/master/site/en/content/query/language.md" class="td-page-meta--edit td-page-meta__edit" target="_blank" rel="noopener"><i class="fa-solid fa-pen-to-square fa-fw"></i> Edit this page</a>
  <a href="https://github.com/bazelbuild/bazel/new/master/site/en/content/query?filename=change-me.md&amp;value=---%0Atitle%3A&#43;%22Long&#43;Page&#43;Title%22%0AlinkTitle%3A&#43;%22Short&#43;Nav&#43;Title%22%0Aweight%3A&#43;100%0Adescription%3A&#43;%3E-%0A&#43;&#43;&#43;&#43;&#43;Page&#43;description&#43;for&#43;heading&#43;and&#43;indexes.%0A---%0A%0A%23%23&#43;Heading%0A%0AEdit&#43;this&#43;template&#43;to&#43;create&#43;your&#43;new&#43;page.%0A%0A%2A&#43;Give&#43;it&#43;a&#43;good&#43;name%2C&#43;ending&#43;in&#43;%60.md%60&#43;-&#43;e.g.&#43;%60getting-started.md%60%0A%2A&#43;Edit&#43;the&#43;%22front&#43;matter%22&#43;section&#43;at&#43;the&#43;top&#43;of&#43;the&#43;page&#43;%28weight&#43;controls&#43;how&#43;its&#43;ordered&#43;amongst&#43;other&#43;pages&#43;in&#43;the&#43;same&#43;directory%3B&#43;lowest&#43;number&#43;first%29.%0A%2A&#43;Add&#43;a&#43;good&#43;commit&#43;message&#43;at&#43;the&#43;bottom&#43;of&#43;the&#43;page&#43;%28%3C80&#43;characters%3B&#43;use&#43;the&#43;extended&#43;description&#43;field&#43;for&#43;more&#43;detail%29.%0A%2A&#43;Create&#43;a&#43;new&#43;branch&#43;so&#43;you&#43;can&#43;preview&#43;your&#43;new&#43;file&#43;and&#43;request&#43;a&#43;review&#43;via&#43;Pull&#43;Request.%0A" class="td-page-meta--child td-page-meta__child" target="_blank" rel="noopener"><i class="fa-solid fa-pen-to-square fa-fw"></i> Create child page</a>
  <a href="https://github.com/bazelbuild/bazel/issues/new?title=The%20Bazel%20Query%20Reference" class="td-page-meta--issue td-page-meta__issue" target="_blank" rel="noopener"><i class="fa-solid fa-list-check fa-fw"></i> Create documentation issue</a>
  
</div>

            <div class="td-toc">
        <nav id="TableOfContents">
  <ul>
    <li><a href="#additional-query-reference">Additional query reference</a>
      <ul>
        <li><a href="#action-graph-query">Action graph query</a></li>
        <li><a href="#configurable-query">Configurable query</a></li>
      </ul>
    </li>
    <li><a href="#examples">Examples</a></li>
    <li><a href="#tokens-the-lexical-syntax">Tokens: The lexical syntax</a></li>
    <li><a href="#bazel-query-language-concepts">Bazel query language concepts</a>
      <ul>
        <li><a href="#cycles-in-the-dependency-graph">Cycles in the dependency graph</a></li>
        <li><a href="#implicit-dependencies">Implicit dependencies</a></li>
        <li><a href="#soundness">Soundness</a></li>
        <li><a href="#on-the-preservation-of-graph-order">On the preservation of graph order</a></li>
        <li><a href="#display-a-graph-of-the-result">Display a graph of the result</a></li>
        <li><a href="#regular-expressions">Regular expressions</a></li>
        <li><a href="#querying-with-external-repositories">Querying with external repositories</a></li>
      </ul>
    </li>
  </ul>
</nav>
      </div>
    
            
	
          </aside>
          <main class="col-12 col-md-9 col-xl-8 ps-md-5" role="main">
            
  

            <nav aria-label="breadcrumb" class="td-breadcrumbs">
  <ol class="breadcrumb">
  <li class="breadcrumb-item">
    <a href="/query/">Query</a></li>
  <li class="breadcrumb-item active" aria-current="page">
    The Bazel Query Reference</li>
  </ol>
</nav>
<div class="td-content">
	<h1>The Bazel Query Reference</h1>
	
	<header class="article-meta">
		
  </header>
	<p>This page is the reference manual for the <em>Bazel Query Language</em> used
when you use <code>bazel query</code> to analyze build dependencies. It also
describes the output formats <code>bazel query</code> supports.</p>
<p>For practical use cases, see the <a href="/query/guide/">Bazel Query How-To</a>.</p>
<h2 id="additional-query-reference">Additional query reference</h2>
<p>In addition to <code>query</code>, which runs on the post-loading phase target graph,
Bazel includes <em>action graph query</em> and <em>configurable query</em>.</p>
<h3 id="action-graph-query">Action graph query</h3>
<p>The action graph query (<code>aquery</code>) operates on the post-analysis Configured
Target Graph and exposes information about <strong>Actions</strong>, <strong>Artifacts</strong>, and
their relationships. <code>aquery</code> is useful when you are interested in the
properties of the Actions/Artifacts generated from the Configured Target Graph.
For example, the actual commands run and their inputs, outputs, and mnemonics.</p>
<p>For more details, see the <a href="/query/aquery/">aquery reference</a>.</p>
<h3 id="configurable-query">Configurable query</h3>
<p>Traditional Bazel query runs on the post-loading phase target graph and
therefore has no concept of configurations and their related concepts. Notably,
it doesn&rsquo;t correctly resolve <a href="/reference/be/functions#select/">select statements</a>
and instead returns all possible resolutions of selects. However, the
configurable query environment, <code>cquery</code>, properly handles configurations but
doesn&rsquo;t provide all of the functionality of this original query.</p>
<p>For more details, see the <a href="/query/cquery/">cquery reference</a>.</p>
<h2 id="examples">Examples</h2>
<p>How do people use <code>bazel query</code>?  Here are typical examples:</p>
<p>Why does the <code>//foo</code> tree depend on <code>//bar/baz</code>?
Show a path:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">somepath(foo/..., //bar/baz:all)
</span></span></code></pre></div><p>What C++ libraries do all the <code>foo</code> tests depend on that
the <code>foo_bin</code> target does not?</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">kind(&#34;cc_library&#34;, deps(kind(&#34;.*test rule&#34;, foo/...)) except deps(//foo:foo_bin))
</span></span></code></pre></div><h2 id="tokens-the-lexical-syntax">Tokens: The lexical syntax</h2>
<p>Expressions in the query language are composed of the following
tokens:</p>
<ul>
<li>
<p><strong>Keywords</strong>, such as <code>let</code>. Keywords are the reserved words of the
language, and each of them is described below. The complete set
of keywords is:</p>
<ul>
<li>
<p><a href="#set-operations"><code>except</code></a></p>
</li>
<li>
<p><a href="#variables"><code>in</code></a></p>
</li>
<li>
<p><a href="#set-operations"><code>intersect</code></a></p>
</li>
<li>
<p><a href="#variables"><code>let</code></a></p>
</li>
<li>
<p><a href="#set"><code>set</code></a></p>
</li>
<li>
<p><a href="#set-operations"><code>union</code></a></p>
</li>
</ul>
</li>
<li>
<p><strong>Words</strong>, such as &ldquo;<code>foo/...</code>&rdquo; or &ldquo;<code>.*test rule</code>&rdquo; or &ldquo;<code>//bar/baz:all</code>&rdquo;. If a
character sequence is &ldquo;quoted&rdquo; (begins and ends with a single-quote &rsquo; or
begins and ends with a double-quote &ldquo;), it is a word. If a character sequence
is not quoted, it may still be parsed as a word. Unquoted words are sequences
of characters drawn from the alphabet characters A-Za-z, the numerals 0-9,
and the special characters <code>*/@.-_:$~[]</code> (asterisk, forward slash, at, period,
hyphen, underscore, colon, dollar sign, tilde, left square brace, right square
brace). However, unquoted words may not start with a hyphen <code>-</code> or asterisk <code>*</code>
even though relative <a href="/concepts/labels#target-names/">target names</a> may start
with those characters. As a special rule meant to simplify the handling of
labels referring to external repositories, unquoted words that start with
<code>@@</code> may contain <code>+</code> characters.</p>
<p>Unquoted words also may not include the characters plus sign <code>+</code> or equals
sign <code>=</code>, even though those characters are permitted in target names. When
writing code that generates query expressions, target names should be quoted.</p>
<p>Quoting <em>is</em> necessary when writing scripts that construct Bazel query
expressions from user-supplied values.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl"> //foo:bar+wiz    # WRONG: scanned as //foo:bar + wiz.
</span></span><span class="line"><span class="cl"> //foo:bar=wiz    # WRONG: scanned as //foo:bar = wiz.
</span></span><span class="line"><span class="cl"> &#34;//foo:bar+wiz&#34;  # OK.
</span></span><span class="line"><span class="cl"> &#34;//foo:bar=wiz&#34;  # OK.
</span></span></code></pre></div><p>Note that this quoting is in addition to any quoting that may be required by
your shell, such as:</p>

<div class="chem">$$bazel query ' "//foo:bar=wiz" '   # single-quotes for shell, double-quotes for Bazel.$$</div><p>Keywords and operators, when quoted, are treated as ordinary words. For example, <code>some</code> is a
keyword but &ldquo;some&rdquo; is a word. Both <code>foo</code> and &ldquo;foo&rdquo; are words.</p>
<p>However, be careful when using single or double quotes in target names. When
quoting one or more target names, use only one type of quotes (either all
single or all double quotes).</p>
<p>The following are examples of what the Java query string will be:</p>

<div class="chem">$$  'a"'a'         # WRONG: Error message: unclosed quotation.
  "a'"a"         # WRONG: Error message: unclosed quotation.
  '"a" + 'a''    # WRONG: Error message: unexpected token 'a' after query expression '"a" + '
  "'a' + "a""    # WRONG: Error message: unexpected token 'a' after query expression ''a' + '
  "a'a"          # OK.
  'a"a'          # OK.
  '"a" + "a"'    # OK
  "'a' + 'a'"    # OK$$</div><p>We chose this syntax so that quote marks aren&rsquo;t needed in most cases. The
(unusual) <code>&quot;.*test rule&quot;</code> example needs quotes: it starts with a period and
contains a space. Quoting <code>&quot;cc_library&quot;</code> is unnecessary but harmless.</p>
</li>
<li>
<p><strong>Punctuation</strong>, such as parens <code>()</code>, period <code>.</code> and comma <code>,</code>. Words
containing punctuation (other than the exceptions listed above) must be quoted.</p>
</li>
</ul>
<p>Whitespace characters outside of a quoted word are ignored.</p>
<h2 id="bazel-query-language-concepts">Bazel query language concepts</h2>
<p>The Bazel query language is a language of expressions. Every
expression evaluates to a <strong>partially-ordered set</strong> of targets,
or equivalently, a <strong>graph</strong> (DAG) of targets. This is the only
datatype.</p>
<p>Set and graph refer to the same datatype, but emphasize different
aspects of it, for example:</p>
<ul>
<li><strong>Set:</strong> The partial order of the targets is not interesting.</li>
<li><strong>Graph:</strong> The partial order of targets is significant.</li>
</ul>
<h3 id="cycles-in-the-dependency-graph">Cycles in the dependency graph</h3>
<p>Build dependency graphs should be acyclic.</p>
<p>The algorithms used by the query language are robust against cycles, and will
not report cycles as errors.</p>
<p>Note that the post-loading phase unconfigured target graph that <code>bazel query</code>
operates over may contain cycles that do not exist in the configured target
graph. Cycles in the configured target graph are detected and reported as errors
by <a href="/query/cquery/"><code>bazel cquery</code></a> and <a href="/query/aquery/"><code>bazel aquery</code></a>.</p>
<h3 id="implicit-dependencies">Implicit dependencies</h3>
<p>In addition to build dependencies that are defined explicitly in <code>BUILD</code> files,
Bazel adds additional <em>implicit</em> dependencies to rules. Implicit dependencies
may be defined by:</p>
<ul>
<li><a href="/extending/rules#private_attributes_and_implicit_dependencies/">Private attributes</a></li>
<li><a href="/extending/toolchains#writing-rules-toolchains/">Toolchain requirements</a></li>
</ul>
<p>By default, <code>bazel query</code> takes implicit dependencies into account
when computing the query result. This behavior can be changed with
the <code>--[no]implicit_deps</code> option.</p>
<p>Note that, as query does not consider configurations, potential toolchain
<strong>implementations</strong> are not considered dependencies, only the
required toolchain types. See
<a href="/extending/toolchains#writing-rules-toolchains/">toolchain documentation</a>.</p>
<h3 id="soundness">Soundness</h3>
<p>Bazel query language expressions operate over the build
dependency graph, which is the graph implicitly defined by all
rule declarations in all <code>BUILD</code> files. It is important to understand
that this graph is somewhat abstract, and does not constitute a
complete description of how to perform all the steps of a build. In
order to perform a build, a <em>configuration</em> is required too;
see the <a href="/docs/user-manual#configurations/">configurations</a>
section of the User&rsquo;s Guide for more detail.</p>
<p>The result of evaluating an expression in the Bazel query language
is true <em>for all configurations</em>, which means that it may be
a conservative over-approximation, and not exactly precise. If you
use the query tool to compute the set of all source files needed
during a build, it may report more than are actually necessary
because, for example, the query tool will include all the files
needed to support message translation, even though you don&rsquo;t intend
to use that feature in your build.</p>
<h3 id="on-the-preservation-of-graph-order">On the preservation of graph order</h3>
<p>Operations preserve any ordering
constraints inherited from their subexpressions. You can think of
this as &ldquo;the law of conservation of partial order&rdquo;. Consider an
example: if you issue a query to determine the transitive closure of
dependencies of a particular target, the resulting set is ordered
according to the dependency graph. If you filter that set to
include only the targets of <code>file</code> kind, the same
<em>transitive</em> partial ordering relation holds between every
pair of targets in the resulting subset - even though none of
these pairs is actually directly connected in the original graph.
(There are no file-file edges in the build dependency graph).</p>
<p>However, while all operators <em>preserve</em> order, some
operations, such as the <a href="#set-operations">set operations</a>
don&rsquo;t <em>introduce</em> any ordering constraints of their own.
Consider this expression:</p>

<div class="chem">$$deps(x) union y
```python
The order of the final result set is guaranteed to preserve all the
ordering constraints of its subexpressions, namely, that all the
transitive dependencies of `x` are correctly ordered with
respect to each other. However, the query guarantees nothing about
the ordering of the targets in `y`, nor about the
ordering of the targets in `deps(x)` relative to those in
`y` (except for those targets in
`y` that also happen to be in `deps(x)`).

Operators that introduce ordering constraints include:
`allpaths`, `deps`, `rdeps`, `somepath`, and the target pattern wildcards
`package:*`, `dir/...`, etc.

### Sky query

_Sky Query_ is a mode of query that operates over a specified _universe scope_.

#### Special functions available only in SkyQuery

Sky Query mode has the additional query functions `allrdeps` and
`rbuildfiles`. These functions operate over the entire
universe scope (which is why they don't make sense for normal Query).

#### Specifying a universe scope

Sky Query mode is activated by passing the following two flags:
(`--universe_scope` or `--infer_universe_scope`) and
`--order_output=no`.
`--universe_scope=<target_pattern1>,...,<target_patternN>` tells query to
preload the transitive closure of the target pattern specified by the target patterns, which can
be both additive and subtractive. All queries are then evaluated in this "scope". In particular,
the [`allrdeps`](#allrdeps) and
[`rbuildfiles`](#rbuildfiles) operators only return results from this scope.
`--infer_universe_scope` tells Bazel to infer a value for `--universe_scope`
from the query expression. This inferred value is the list of unique target patterns in the
query expression, but this might not be what you want. For example:$$</div><p>bazel query &ndash;infer_universe_scope &ndash;order_output=no &ldquo;allrdeps(//my:target)&rdquo;</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">The list of unique target patterns in this query expression is `[&#34;//my:target&#34;]`, so
</span></span><span class="line"><span class="cl">Bazel treats this the same as the invocation:
</span></span></code></pre></div><p>bazel query &ndash;universe_scope=//my:target &ndash;order_output=no &ldquo;allrdeps(//my:target)&rdquo;</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">But the result of that query with `--universe_scope` is only `//my:target`;
</span></span><span class="line"><span class="cl">none of the reverse dependencies of `//my:target` are in the universe, by
</span></span><span class="line"><span class="cl">construction! On the other hand, consider:
</span></span></code></pre></div><p>bazel query &ndash;infer_universe_scope &ndash;order_output=no &ldquo;tests(//a/&hellip; + b/&hellip;) intersect allrdeps(siblings(rbuildfiles(my/starlark/file.bzl)))&rdquo;</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">This is a meaningful query invocation that is trying to compute the test targets in the
</span></span><span class="line"><span class="cl">[`tests`](#tests) expansion of the targets under some directories that
</span></span><span class="line"><span class="cl">transitively depend on targets whose definition uses a certain `.bzl` file. Here,
</span></span><span class="line"><span class="cl">`--infer_universe_scope` is a convenience, especially in the case where the choice of
</span></span><span class="line"><span class="cl">`--universe_scope` would otherwise require you to parse the query expression yourself.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">So, for query expressions that use universe-scoped operators like
</span></span><span class="line"><span class="cl">[`allrdeps`](#allrdeps) and
</span></span><span class="line"><span class="cl">[`rbuildfiles`](#rbuildfiles) be sure to use
</span></span><span class="line"><span class="cl">`--infer_universe_scope` only if its behavior is what you want.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Sky Query has some advantages and disadvantages compared to the default query. The main
</span></span><span class="line"><span class="cl">disadvantage is that it cannot order its output according to graph order, and thus certain
</span></span><span class="line"><span class="cl">[output formats](#output-formats) are forbidden. Its advantages are that it provides
</span></span><span class="line"><span class="cl">two operators ([`allrdeps`](#allrdeps) and
</span></span><span class="line"><span class="cl">[`rbuildfiles`](#rbuildfiles)) that are not available in the default query.
</span></span><span class="line"><span class="cl">As well, Sky Query does its work by introspecting the
</span></span><span class="line"><span class="cl">[Skyframe](/reference/skyframe/) graph, rather than creating a new
</span></span><span class="line"><span class="cl">graph, which is what the default implementation does. Thus, there are some circumstances in which
</span></span><span class="line"><span class="cl">it is faster and uses less memory.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">## Expressions: Syntax and semantics of the grammar
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">This is the grammar of the Bazel query language, expressed in EBNF notation:
</span></span></code></pre></div><p>expr ::= {{ &lsquo;<var>&rsquo; }}word{{ &lsquo;</var>&rsquo; }}
| let {{ &lsquo;<var>&rsquo; }}name{{ &lsquo;</var>&rsquo; }} = {{ &lsquo;<var>&rsquo; }}expr{{ &lsquo;</var>&rsquo; }} in {{ &lsquo;<var>&rsquo; }}expr{{ &lsquo;</var>&rsquo; }}
| ({{ &lsquo;<var>&rsquo; }}expr{{ &lsquo;</var>&rsquo; }})
| {{ &lsquo;<var>&rsquo; }}expr{{ &lsquo;</var>&rsquo; }} intersect {{ &lsquo;<var>&rsquo; }}expr{{ &lsquo;</var>&rsquo; }}
| {{ &lsquo;<var>&rsquo; }}expr{{ &lsquo;</var>&rsquo; }} ^ {{ &lsquo;<var>&rsquo; }}expr{{ &lsquo;</var>&rsquo; }}
| {{ &lsquo;<var>&rsquo; }}expr{{ &lsquo;</var>&rsquo; }} union {{ &lsquo;<var>&rsquo; }}expr{{ &lsquo;</var>&rsquo; }}
| {{ &lsquo;<var>&rsquo; }}expr{{ &lsquo;</var>&rsquo; }} + {{ &lsquo;<var>&rsquo; }}expr{{ &lsquo;</var>&rsquo; }}
| {{ &lsquo;<var>&rsquo; }}expr{{ &lsquo;</var>&rsquo; }} except {{ &lsquo;<var>&rsquo; }}expr{{ &lsquo;</var>&rsquo; }}
| {{ &lsquo;<var>&rsquo; }}expr{{ &lsquo;</var>&rsquo; }} - {{ &lsquo;<var>&rsquo; }}expr{{ &lsquo;</var>&rsquo; }}
| set({{ &lsquo;<var>&rsquo; }}word{{ &lsquo;</var>&rsquo; }} *)
| {{ &lsquo;<var>&rsquo; }}word{{ &lsquo;</var>&rsquo; }} &lsquo;(&rsquo; {{ &lsquo;<var>&rsquo; }}int{{ &lsquo;</var>&rsquo; }} | {{ &lsquo;<var>&rsquo; }}word{{ &lsquo;</var>&rsquo; }} | {{ &lsquo;<var>&rsquo; }}expr{{ &lsquo;</var>&rsquo; }} &hellip; &lsquo;)&rsquo;</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">The following sections describe each of the productions of this grammar in order.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">### Target patterns
</span></span></code></pre></div><p>expr ::= {{ &lsquo;<var>&rsquo; }}word{{ &lsquo;</var>&rsquo; }}</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">Syntactically, a _target pattern_ is just a word. It&#39;s interpreted as an
</span></span><span class="line"><span class="cl">(unordered) set of targets. The simplest target pattern is a label, which
</span></span><span class="line"><span class="cl">identifies a single target (file or rule). For example, the target pattern
</span></span><span class="line"><span class="cl">`//foo:bar` evaluates to a set containing one element, the target, the `bar`
</span></span><span class="line"><span class="cl">rule.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Target patterns generalize labels to include wildcards over packages and
</span></span><span class="line"><span class="cl">targets. For example, `foo/...:all` (or just `foo/...`) is a target pattern
</span></span><span class="line"><span class="cl">that evaluates to a set containing all _rules_ in every package recursively
</span></span><span class="line"><span class="cl">beneath the `foo` directory; `bar/baz:all` is a target pattern that evaluates
</span></span><span class="line"><span class="cl">to a set containing all the rules in the `bar/baz` package, but not its
</span></span><span class="line"><span class="cl">subpackages.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Similarly, `foo/...:*` is a target pattern that evaluates to a set containing
</span></span><span class="line"><span class="cl">all _targets_ (rules _and_ files) in every package recursively beneath the
</span></span><span class="line"><span class="cl">`foo` directory; `bar/baz:*` evaluates to a set containing all the targets in
</span></span><span class="line"><span class="cl">the `bar/baz` package, but not its subpackages.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Because the `:*` wildcard matches files as well as rules, it&#39;s often more
</span></span><span class="line"><span class="cl">useful than `:all` for queries. Conversely, the `:all` wildcard (implicit in
</span></span><span class="line"><span class="cl">target patterns like `foo/...`) is typically more useful for builds.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">`bazel query` target patterns work the same as `bazel build` build targets do.
</span></span><span class="line"><span class="cl">For more details, see [Target Patterns](/docs/user-manual#target-patterns/), or
</span></span><span class="line"><span class="cl">type `bazel help target-syntax`.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Target patterns may evaluate to a singleton set (in the case of a label), to a
</span></span><span class="line"><span class="cl">set containing many elements (as in the case of `foo/...`, which has thousands
</span></span><span class="line"><span class="cl">of elements) or to the empty set, if the target pattern matches no targets.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">All nodes in the result of a target pattern expression are correctly ordered
</span></span><span class="line"><span class="cl">relative to each other according to the dependency relation. So, the result of
</span></span><span class="line"><span class="cl">`foo:*` is not just the set of targets in package `foo`, it is also the
</span></span><span class="line"><span class="cl">_graph_ over those targets. (No guarantees are made about the relative ordering
</span></span><span class="line"><span class="cl">of the result nodes against other nodes.) For more details, see the
</span></span><span class="line"><span class="cl">[graph order](#graph-order) section.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">### Variables
</span></span></code></pre></div><p>expr ::= let {{ &lsquo;<var>&rsquo; }}name{{ &lsquo;</var>&rsquo; }} = {{ &lsquo;<var>&rsquo; }}expr{{ &lsquo;</var>&rsquo; }}{{ &lsquo;<sub>&rsquo; }}1{{ &lsquo;</sub>&rsquo; }} in {{ &lsquo;<var>&rsquo; }}expr{{ &lsquo;</var>&rsquo; }}{{ &lsquo;<sub>&rsquo; }}2{{ &lsquo;</sub>&rsquo; }}
| {{ &lsquo;<var>&rsquo; }}$name{{ &lsquo;</var>&rsquo; }}</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">The</span> <span class="n">Bazel</span> <span class="n">query</span> <span class="n">language</span> <span class="n">allows</span> <span class="n">definitions</span> <span class="n">of</span> <span class="ow">and</span> <span class="n">references</span> <span class="n">to</span>
</span></span><span class="line"><span class="cl"><span class="n">variables</span><span class="o">.</span> <span class="n">The</span> <span class="n">result</span> <span class="n">of</span> <span class="n">evaluation</span> <span class="n">of</span> <span class="n">a</span> <span class="err">`</span><span class="n">let</span><span class="err">`</span> <span class="n">expression</span> <span class="ow">is</span> <span class="n">the</span> <span class="n">same</span> <span class="k">as</span>
</span></span><span class="line"><span class="cl"><span class="n">that</span> <span class="n">of</span> <span class="p">{{</span> <span class="s1">&#39;&lt;var&gt;&#39;</span> <span class="p">}}</span><span class="n">expr</span><span class="p">{{</span> <span class="s1">&#39;&lt;/var&gt;&#39;</span> <span class="p">}}</span><span class="o">&lt;</span><span class="n">sub</span><span class="o">&gt;</span><span class="mi">2</span><span class="o">&lt;/</span><span class="n">sub</span><span class="o">&gt;</span><span class="p">,</span> <span class="k">with</span> <span class="nb">all</span> <span class="n">free</span> <span class="n">occurrences</span>
</span></span><span class="line"><span class="cl"><span class="n">of</span> <span class="n">variable</span> <span class="p">{{</span> <span class="s1">&#39;&lt;var&gt;&#39;</span> <span class="p">}}</span><span class="n">name</span><span class="p">{{</span> <span class="s1">&#39;&lt;/var&gt;&#39;</span> <span class="p">}}</span> <span class="n">replaced</span> <span class="n">by</span> <span class="n">the</span> <span class="n">value</span> <span class="n">of</span>
</span></span><span class="line"><span class="cl"><span class="p">{{</span> <span class="s1">&#39;&lt;var&gt;&#39;</span> <span class="p">}}</span><span class="n">expr</span><span class="p">{{</span> <span class="s1">&#39;&lt;/var&gt;&#39;</span> <span class="p">}}</span><span class="o">&lt;</span><span class="n">sub</span><span class="o">&gt;</span><span class="mi">1</span><span class="o">&lt;/</span><span class="n">sub</span><span class="o">&gt;.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">For</span> <span class="n">example</span><span class="p">,</span> <span class="err">`</span><span class="n">let</span> <span class="n">v</span> <span class="o">=</span> <span class="n">foo</span><span class="o">/...</span> <span class="ow">in</span> <span class="n">allpaths</span><span class="p">(</span><span class="err">$</span><span class="n">v</span><span class="p">,</span> <span class="o">//</span><span class="n">common</span><span class="p">)</span> <span class="n">intersect</span> <span class="err">$</span><span class="n">v</span><span class="err">`</span> <span class="ow">is</span>
</span></span><span class="line"><span class="cl"><span class="n">equivalent</span> <span class="n">to</span> <span class="n">the</span> <span class="err">`</span><span class="n">allpaths</span><span class="p">(</span><span class="n">foo</span><span class="o">/...</span><span class="p">,</span><span class="o">//</span><span class="n">common</span><span class="p">)</span> <span class="n">intersect</span> <span class="n">foo</span><span class="o">/...</span><span class="err">`</span><span class="o">.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">An</span> <span class="n">occurrence</span> <span class="n">of</span> <span class="n">a</span> <span class="n">variable</span> <span class="n">reference</span> <span class="err">`</span><span class="n">name</span><span class="err">`</span> <span class="n">other</span> <span class="n">than</span> <span class="ow">in</span>
</span></span><span class="line"><span class="cl"><span class="n">an</span> <span class="n">enclosing</span> <span class="err">`</span><span class="n">let</span> <span class="p">{{</span> <span class="s1">&#39;&lt;var&gt;&#39;</span> <span class="p">}}</span><span class="n">name</span><span class="p">{{</span> <span class="s1">&#39;&lt;/var&gt;&#39;</span> <span class="p">}}</span> <span class="o">=</span> <span class="o">...</span><span class="err">`</span> <span class="n">expression</span> <span class="ow">is</span> <span class="n">an</span>
</span></span><span class="line"><span class="cl"><span class="n">error</span><span class="o">.</span> <span class="n">In</span> <span class="n">other</span> <span class="n">words</span><span class="p">,</span> <span class="n">top</span><span class="o">-</span><span class="n">level</span> <span class="n">query</span> <span class="n">expressions</span> <span class="n">cannot</span> <span class="n">have</span> <span class="n">free</span>
</span></span><span class="line"><span class="cl"><span class="n">variables</span><span class="o">.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">In</span> <span class="n">the</span> <span class="n">above</span> <span class="n">grammar</span> <span class="n">productions</span><span class="p">,</span> <span class="err">`</span><span class="n">name</span><span class="err">`</span> <span class="ow">is</span> <span class="n">like</span> <span class="n">_word_</span><span class="p">,</span> <span class="n">but</span> <span class="k">with</span> <span class="n">the</span>
</span></span><span class="line"><span class="cl"><span class="n">additional</span> <span class="n">constraint</span> <span class="n">that</span> <span class="n">it</span> <span class="n">be</span> <span class="n">a</span> <span class="n">legal</span> <span class="n">identifier</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">C</span> <span class="n">programming</span>
</span></span><span class="line"><span class="cl"><span class="n">language</span><span class="o">.</span> <span class="n">References</span> <span class="n">to</span> <span class="n">the</span> <span class="n">variable</span> <span class="n">must</span> <span class="n">be</span> <span class="n">prepended</span> <span class="k">with</span> <span class="n">the</span> <span class="s2">&#34;$&#34;</span> <span class="n">character</span><span class="o">.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Each</span> <span class="err">`</span><span class="n">let</span><span class="err">`</span> <span class="n">expression</span> <span class="n">defines</span> <span class="n">only</span> <span class="n">a</span> <span class="n">single</span> <span class="n">variable</span><span class="p">,</span> <span class="n">but</span> <span class="n">you</span> <span class="n">can</span> <span class="n">nest</span> <span class="n">them</span><span class="o">.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Both</span> <span class="p">[</span><span class="n">target</span> <span class="n">patterns</span><span class="p">](</span><span class="c1">#target-patterns) and variable references consist of</span>
</span></span><span class="line"><span class="cl"><span class="n">just</span> <span class="n">a</span> <span class="n">single</span> <span class="n">token</span><span class="p">,</span> <span class="n">a</span> <span class="n">word</span><span class="p">,</span> <span class="n">creating</span> <span class="n">a</span> <span class="n">syntactic</span> <span class="n">ambiguity</span><span class="o">.</span> <span class="n">However</span><span class="p">,</span> <span class="n">there</span> <span class="ow">is</span>
</span></span><span class="line"><span class="cl"><span class="n">no</span> <span class="n">semantic</span> <span class="n">ambiguity</span><span class="p">,</span> <span class="n">because</span> <span class="n">the</span> <span class="n">subset</span> <span class="n">of</span> <span class="n">words</span> <span class="n">that</span> <span class="n">are</span> <span class="n">legal</span> <span class="n">variable</span>
</span></span><span class="line"><span class="cl"><span class="n">names</span> <span class="ow">is</span> <span class="n">disjoint</span> <span class="kn">from</span> <span class="nn">the</span> <span class="n">subset</span> <span class="n">of</span> <span class="n">words</span> <span class="n">that</span> <span class="n">are</span> <span class="n">legal</span> <span class="n">target</span> <span class="n">patterns</span><span class="o">.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Technically</span> <span class="n">speaking</span><span class="p">,</span> <span class="err">`</span><span class="n">let</span><span class="err">`</span> <span class="n">expressions</span> <span class="n">do</span> <span class="ow">not</span> <span class="n">increase</span>
</span></span><span class="line"><span class="cl"><span class="n">the</span> <span class="n">expressiveness</span> <span class="n">of</span> <span class="n">the</span> <span class="n">query</span> <span class="n">language</span><span class="p">:</span> <span class="nb">any</span> <span class="n">query</span> <span class="n">expressible</span> <span class="ow">in</span>
</span></span><span class="line"><span class="cl"><span class="n">the</span> <span class="n">language</span> <span class="n">can</span> <span class="n">also</span> <span class="n">be</span> <span class="n">expressed</span> <span class="n">without</span> <span class="n">them</span><span class="o">.</span> <span class="n">However</span><span class="p">,</span> <span class="n">they</span>
</span></span><span class="line"><span class="cl"><span class="n">improve</span> <span class="n">the</span> <span class="n">conciseness</span> <span class="n">of</span> <span class="n">many</span> <span class="n">queries</span><span class="p">,</span> <span class="ow">and</span> <span class="n">may</span> <span class="n">also</span> <span class="n">lead</span> <span class="n">to</span> <span class="n">more</span>
</span></span><span class="line"><span class="cl"><span class="n">efficient</span> <span class="n">query</span> <span class="n">evaluation</span><span class="o">.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">### Parenthesized expressions</span>
</span></span></code></pre></div><p>expr ::= ({{ &lsquo;<var>&rsquo; }}expr{{ &lsquo;</var>&rsquo; }})</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">Parentheses associate subexpressions to force an order of evaluation.
</span></span><span class="line"><span class="cl">A parenthesized expression evaluates to the value of its argument.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">### Algebraic set operations: intersection, union, set difference
</span></span></code></pre></div><p>expr ::= {{ &lsquo;<var>&rsquo; }}expr{{ &lsquo;</var>&rsquo; }} intersect {{ &lsquo;<var>&rsquo; }}expr{{ &lsquo;</var>&rsquo; }}
| {{ &lsquo;<var>&rsquo; }}expr{{ &lsquo;</var>&rsquo; }} ^ {{ &lsquo;<var>&rsquo; }}expr{{ &lsquo;</var>&rsquo; }}
| {{ &lsquo;<var>&rsquo; }}expr{{ &lsquo;</var>&rsquo; }} union {{ &lsquo;<var>&rsquo; }}expr{{ &lsquo;</var>&rsquo; }}
| {{ &lsquo;<var>&rsquo; }}expr{{ &lsquo;</var>&rsquo; }} + {{ &lsquo;<var>&rsquo; }}expr{{ &lsquo;</var>&rsquo; }}
| {{ &lsquo;<var>&rsquo; }}expr{{ &lsquo;</var>&rsquo; }} except {{ &lsquo;<var>&rsquo; }}expr{{ &lsquo;</var>&rsquo; }}
| {{ &lsquo;<var>&rsquo; }}expr{{ &lsquo;</var>&rsquo; }} - {{ &lsquo;<var>&rsquo; }}expr{{ &lsquo;</var>&rsquo; }}</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">These three operators compute the usual set operations over their arguments.
</span></span><span class="line"><span class="cl">Each operator has two forms, a nominal form, such as `intersect`, and a
</span></span><span class="line"><span class="cl">symbolic form, such as `^`. Both forms are equivalent; the symbolic forms are
</span></span><span class="line"><span class="cl">quicker to type. (For clarity, the rest of this page uses the nominal forms.)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">For example,
</span></span></code></pre></div><p>foo/&hellip; except foo/bar/&hellip;</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">evaluates to the set of targets that match `foo/...` but not `foo/bar/...`.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">You can write the same query as:
</span></span></code></pre></div><p>foo/&hellip; - foo/bar/&hellip;</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">The `intersect` (`^`) and `union` (`+`) operations are commutative (symmetric);
</span></span><span class="line"><span class="cl">`except` (`-`) is asymmetric. The parser treats all three operators as
</span></span><span class="line"><span class="cl">left-associative and of equal precedence, so you might want parentheses. For
</span></span><span class="line"><span class="cl">example, the first two of these expressions are equivalent, but the third is not:
</span></span></code></pre></div><p>x intersect y union z
(x intersect y) union z
x intersect (y union z)</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">Important</span><span class="p">:</span> <span class="n">Use</span> <span class="n">parentheses</span> <span class="n">where</span> <span class="n">there</span> <span class="ow">is</span> <span class="nb">any</span> <span class="n">danger</span> <span class="n">of</span> <span class="n">ambiguity</span> <span class="ow">in</span> <span class="n">reading</span> <span class="n">a</span>
</span></span><span class="line"><span class="cl"><span class="n">query</span> <span class="n">expression</span><span class="o">.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">### Read targets from an external source: set</span>
</span></span></code></pre></div><p>expr ::= set({{ &lsquo;<var>&rsquo; }}word{{ &lsquo;</var>&rsquo; }} *)</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">The <span class="sb">`</span>set<span class="o">({{</span> <span class="s1">&#39;&lt;var&gt;&#39;</span> <span class="o">}}</span>a<span class="o">{{</span> <span class="s1">&#39;&lt;/var&gt;&#39;</span> <span class="o">}}</span> <span class="o">{{</span> <span class="s1">&#39;&lt;var&gt;&#39;</span> <span class="o">}}</span>b<span class="o">{{</span> <span class="s1">&#39;&lt;/var&gt;&#39;</span> <span class="o">}}</span> <span class="o">{{</span> <span class="s1">&#39;&lt;var&gt;&#39;</span> <span class="o">}}</span>c<span class="o">{{</span> <span class="s1">&#39;&lt;/var&gt;&#39;</span> <span class="o">}}</span> ...<span class="o">)</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl">operator computes the union of a <span class="nb">set</span> of zero or more
</span></span><span class="line"><span class="cl"><span class="o">[</span>target patterns<span class="o">](</span><span class="c1">#target-patterns), separated by whitespace (no commas).</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">In conjunction with the Bourne shell<span class="err">&#39;</span>s <span class="sb">`</span><span class="k">$(</span>...<span class="k">)</span><span class="sb">`</span> feature, <span class="sb">`</span>set<span class="o">()</span><span class="sb">`</span> provides a
</span></span><span class="line"><span class="cl">means of saving the results of one query in a regular text file, manipulating
</span></span><span class="line"><span class="cl">that text file using other programs <span class="o">(</span>such as standard UNIX shell tools<span class="o">)</span>, and <span class="k">then</span>
</span></span><span class="line"><span class="cl">introducing the result back into the query tool as a value <span class="k">for</span> further
</span></span><span class="line"><span class="cl">processing. For example:
</span></span></code></pre></div><p>bazel query deps(//my:target) &ndash;output=label | grep &hellip; | sed &hellip; | awk &hellip; &gt; foo</p>
<p>bazel query &ldquo;kind(cc_binary, set($(&lt;foo)))&rdquo;</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">In the next example,`kind(cc_library, deps(//some_dir/foo:main, 5))` is
</span></span><span class="line"><span class="cl">computed by filtering on the `maxrank` values using an `awk` program.
</span></span></code></pre></div><p>bazel query &lsquo;deps(//some_dir/foo:main)&rsquo; &ndash;output maxrank | awk &lsquo;($1 &lt; 5) { print $2;} &rsquo; &gt; foo</p>
<p>bazel query &ldquo;kind(cc_library, set($(&lt;foo)))&rdquo;</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="nx">In</span> <span class="nx">these</span> <span class="nx">examples</span><span class="p">,</span> <span class="sb">`$(&lt;foo)`</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">shorthand</span> <span class="k">for</span> <span class="sb">`$(cat foo)`</span><span class="p">,</span> <span class="nx">but</span> <span class="nx">shell</span>
</span></span><span class="line"><span class="cl"><span class="nx">commands</span> <span class="nx">other</span> <span class="nx">than</span> <span class="sb">`cat`</span> <span class="nx">may</span> <span class="nx">be</span> <span class="nx">used</span> <span class="nx">too</span><span class="err"></span><span class="nx">such</span> <span class="nx">as</span> <span class="nx">the</span> <span class="nx">previous</span> <span class="sb">`awk`</span> <span class="nx">command</span><span class="p">.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">Note</span><span class="o">:</span> <span class="sb">`set()`</span> <span class="nx">introduces</span> <span class="nx">no</span> <span class="nx">graph</span> <span class="nx">ordering</span> <span class="nx">constraints</span><span class="p">,</span> <span class="nx">so</span> <span class="nx">path</span> <span class="nx">information</span> <span class="nx">may</span>
</span></span><span class="line"><span class="cl"><span class="nx">be</span> <span class="nx">lost</span> <span class="nx">when</span> <span class="nx">saving</span> <span class="nx">and</span> <span class="nx">reloading</span> <span class="nx">sets</span> <span class="k">of</span> <span class="nx">nodes</span> <span class="nx">using</span> <span class="nx">it</span><span class="p">.</span> <span class="nx">For</span> <span class="nx">more</span> <span class="nx">details</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="nx">see</span> <span class="nx">the</span> <span class="p">[</span><span class="nx">graph</span> <span class="nx">order</span><span class="p">](</span><span class="err">#</span><span class="nx">graph</span><span class="o">-</span><span class="nx">order</span><span class="p">)</span> <span class="nx">section</span> <span class="nx">below</span><span class="p">.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">##</span> <span class="nx">Functions</span>
</span></span></code></pre></div><p>expr ::= {{ &lsquo;<var>&rsquo; }}word{{ &lsquo;</var>&rsquo; }} &lsquo;(&rsquo; {{ &lsquo;<var>&rsquo; }}int{{ &lsquo;</var>&rsquo; }} | {{ &lsquo;<var>&rsquo; }}word{{ &lsquo;</var>&rsquo; }} | {{ &lsquo;<var>&rsquo; }}expr{{ &lsquo;</var>&rsquo; }} &hellip; &lsquo;)&rsquo;</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="nx">The</span> <span class="nx">query</span> <span class="nx">language</span> <span class="nx">defines</span> <span class="nx">several</span> <span class="nx">functions</span><span class="p">.</span> <span class="nx">The</span> <span class="nx">name</span> <span class="k">of</span> <span class="nx">the</span> <span class="kd">function</span>
</span></span><span class="line"><span class="cl"><span class="nx">determines</span> <span class="nx">the</span> <span class="nx">number</span> <span class="nx">and</span> <span class="nx">type</span> <span class="k">of</span> <span class="nx">arguments</span> <span class="nx">it</span> <span class="nx">requires</span><span class="p">.</span> <span class="nx">The</span> <span class="nx">following</span>
</span></span><span class="line"><span class="cl"><span class="nx">functions</span> <span class="nx">are</span> <span class="nx">available</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">*</span> <span class="p">[</span><span class="sb">`allpaths`</span><span class="p">](</span><span class="err">#</span><span class="nx">somepath</span><span class="o">-</span><span class="nx">allpaths</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">*</span> <span class="p">[</span><span class="sb">`attr`</span><span class="p">](</span><span class="err">#</span><span class="nx">attr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">*</span> <span class="p">[</span><span class="sb">`buildfiles`</span><span class="p">](</span><span class="err">#</span><span class="nx">buildfiles</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">*</span> <span class="p">[</span><span class="sb">`rbuildfiles`</span><span class="p">](</span><span class="err">#</span><span class="nx">rbuildfiles</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">*</span> <span class="p">[</span><span class="sb">`deps`</span><span class="p">](</span><span class="err">#</span><span class="nx">deps</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">*</span> <span class="p">[</span><span class="sb">`filter`</span><span class="p">](</span><span class="err">#</span><span class="nx">filter</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">*</span> <span class="p">[</span><span class="sb">`kind`</span><span class="p">](</span><span class="err">#</span><span class="nx">kind</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">*</span> <span class="p">[</span><span class="sb">`labels`</span><span class="p">](</span><span class="err">#</span><span class="nx">labels</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">*</span> <span class="p">[</span><span class="sb">`loadfiles`</span><span class="p">](</span><span class="err">#</span><span class="nx">loadfiles</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">*</span> <span class="p">[</span><span class="sb">`rdeps`</span><span class="p">](</span><span class="err">#</span><span class="nx">rdeps</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">*</span> <span class="p">[</span><span class="sb">`allrdeps`</span><span class="p">](</span><span class="err">#</span><span class="nx">allrdeps</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">*</span> <span class="p">[</span><span class="sb">`same_pkg_direct_rdeps`</span><span class="p">](</span><span class="err">#</span><span class="nx">same_pkg_direct_rdeps</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">*</span> <span class="p">[</span><span class="sb">`siblings`</span><span class="p">](</span><span class="err">#</span><span class="nx">siblings</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">*</span> <span class="p">[</span><span class="sb">`some`</span><span class="p">](</span><span class="err">#</span><span class="nx">some</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">*</span> <span class="p">[</span><span class="sb">`somepath`</span><span class="p">](</span><span class="err">#</span><span class="nx">somepath</span><span class="o">-</span><span class="nx">allpaths</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">*</span> <span class="p">[</span><span class="sb">`tests`</span><span class="p">](</span><span class="err">#</span><span class="nx">tests</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">*</span> <span class="p">[</span><span class="sb">`visible`</span><span class="p">](</span><span class="err">#</span><span class="nx">visible</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">###</span> <span class="nx">Transitive</span> <span class="nx">closure</span> <span class="k">of</span> <span class="nx">dependencies</span><span class="o">:</span> <span class="nx">deps</span>
</span></span></code></pre></div><p>expr ::= deps({{ &lsquo;<var>&rsquo; }}expr{{ &lsquo;</var>&rsquo; }})
| deps({{ &lsquo;<var>&rsquo; }}expr{{ &lsquo;</var>&rsquo; }}, {{ &lsquo;<var>&rsquo; }}depth{{ &lsquo;</var>&rsquo; }})</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">The `deps({{ &#39;&lt;var&gt;&#39; }}x{{ &#39;&lt;/var&gt;&#39; }})` operator evaluates to the graph formed
</span></span><span class="line"><span class="cl">by the transitive closure of dependencies of its argument set
</span></span><span class="line"><span class="cl">{{ &#39;&lt;var&gt;&#39; }}x{{ &#39;&lt;/var&gt;&#39; }}. For example, the value of `deps(//foo)` is the
</span></span><span class="line"><span class="cl">dependency graph rooted at the single node `foo`, including all its
</span></span><span class="line"><span class="cl">dependencies. The value of `deps(foo/...)` is the dependency graphs whose roots
</span></span><span class="line"><span class="cl">are all rules in every package beneath the `foo` directory. In this context,
</span></span><span class="line"><span class="cl">&#39;dependencies&#39; means only rule and file targets, therefore the `BUILD` and
</span></span><span class="line"><span class="cl">Starlark files needed to create these targets are not included here. For that
</span></span><span class="line"><span class="cl">you should use the [`buildfiles`](#buildfiles) operator.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">The resulting graph is ordered according to the dependency relation. For more
</span></span><span class="line"><span class="cl">details, see the section on [graph order](#graph-order).
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">The `deps` operator accepts an optional second argument, which is an integer
</span></span><span class="line"><span class="cl">literal specifying an upper bound on the depth of the search. So
</span></span><span class="line"><span class="cl">`deps(foo:*, 0)` returns all targets in the `foo` package, while
</span></span><span class="line"><span class="cl">`deps(foo:*, 1)` further includes the direct prerequisites of any target in the
</span></span><span class="line"><span class="cl">`foo` package, and `deps(foo:*, 2)` further includes the nodes directly
</span></span><span class="line"><span class="cl">reachable from the nodes in `deps(foo:*, 1)`, and so on. (These numbers
</span></span><span class="line"><span class="cl">correspond to the ranks shown in the [`minrank`](#output-ranked) output format.)
</span></span><span class="line"><span class="cl">If the {{ &#39;&lt;var&gt;&#39; }}depth{{ &#39;&lt;/var&gt;&#39; }} parameter is omitted, the search is
</span></span><span class="line"><span class="cl">unbounded: it computes the reflexive transitive closure of prerequisites.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">### Transitive closure of reverse dependencies: rdeps
</span></span></code></pre></div><p>expr ::= rdeps({{ &lsquo;<var>&rsquo; }}expr{{ &lsquo;</var>&rsquo; }}, {{ &lsquo;<var>&rsquo; }}expr{{ &lsquo;</var>&rsquo; }})
| rdeps({{ &lsquo;<var>&rsquo; }}expr{{ &lsquo;</var>&rsquo; }}, {{ &lsquo;<var>&rsquo; }}expr{{ &lsquo;</var>&rsquo; }}, {{ &lsquo;<var>&rsquo; }}depth{{ &lsquo;</var>&rsquo; }})</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">The</span> <span class="err">`</span><span class="n">rdeps</span><span class="p">({{</span> <span class="s1">&#39;&lt;var&gt;&#39;</span> <span class="p">}}</span><span class="n">u</span><span class="p">{{</span> <span class="s1">&#39;&lt;/var&gt;&#39;</span> <span class="p">}},</span> <span class="p">{{</span> <span class="s1">&#39;&lt;var&gt;&#39;</span> <span class="p">}}</span><span class="n">x</span><span class="p">{{</span> <span class="s1">&#39;&lt;/var&gt;&#39;</span> <span class="p">}})</span><span class="err">`</span>
</span></span><span class="line"><span class="cl"><span class="n">operator</span> <span class="n">evaluates</span> <span class="n">to</span> <span class="n">the</span> <span class="n">reverse</span> <span class="n">dependencies</span> <span class="n">of</span> <span class="n">the</span> <span class="n">argument</span> <span class="nb">set</span>
</span></span><span class="line"><span class="cl"><span class="p">{{</span> <span class="s1">&#39;&lt;var&gt;&#39;</span> <span class="p">}}</span><span class="n">x</span><span class="p">{{</span> <span class="s1">&#39;&lt;/var&gt;&#39;</span> <span class="p">}}</span> <span class="n">within</span> <span class="n">the</span> <span class="n">transitive</span> <span class="n">closure</span> <span class="n">of</span> <span class="n">the</span> <span class="n">universe</span> <span class="nb">set</span>
</span></span><span class="line"><span class="cl"><span class="p">{{</span> <span class="s1">&#39;&lt;var&gt;&#39;</span> <span class="p">}}</span><span class="n">u</span><span class="p">{{</span> <span class="s1">&#39;&lt;/var&gt;&#39;</span> <span class="p">}}</span><span class="o">.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">The</span> <span class="n">resulting</span> <span class="n">graph</span> <span class="ow">is</span> <span class="n">ordered</span> <span class="n">according</span> <span class="n">to</span> <span class="n">the</span> <span class="n">dependency</span> <span class="n">relation</span><span class="o">.</span> <span class="n">See</span> <span class="n">the</span>
</span></span><span class="line"><span class="cl"><span class="n">section</span> <span class="n">on</span> <span class="p">[</span><span class="n">graph</span> <span class="n">order</span><span class="p">](</span><span class="c1">#graph-order) for more details.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">The</span> <span class="err">`</span><span class="n">rdeps</span><span class="err">`</span> <span class="n">operator</span> <span class="n">accepts</span> <span class="n">an</span> <span class="n">optional</span> <span class="n">third</span> <span class="n">argument</span><span class="p">,</span> <span class="n">which</span> <span class="ow">is</span> <span class="n">an</span> <span class="n">integer</span>
</span></span><span class="line"><span class="cl"><span class="n">literal</span> <span class="n">specifying</span> <span class="n">an</span> <span class="n">upper</span> <span class="n">bound</span> <span class="n">on</span> <span class="n">the</span> <span class="n">depth</span> <span class="n">of</span> <span class="n">the</span> <span class="n">search</span><span class="o">.</span> <span class="n">The</span> <span class="n">resulting</span>
</span></span><span class="line"><span class="cl"><span class="n">graph</span> <span class="n">only</span> <span class="n">includes</span> <span class="n">nodes</span> <span class="n">within</span> <span class="n">a</span> <span class="n">distance</span> <span class="n">of</span> <span class="n">the</span> <span class="n">specified</span> <span class="n">depth</span> <span class="kn">from</span> <span class="nn">any</span>
</span></span><span class="line"><span class="cl"><span class="n">node</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">argument</span> <span class="nb">set</span><span class="o">.</span> <span class="n">So</span> <span class="err">`</span><span class="n">rdeps</span><span class="p">(</span><span class="o">//</span><span class="n">foo</span><span class="p">,</span> <span class="o">//</span><span class="n">common</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="err">`</span> <span class="n">evaluates</span> <span class="n">to</span> <span class="nb">all</span> <span class="n">nodes</span>
</span></span><span class="line"><span class="cl"><span class="ow">in</span> <span class="n">the</span> <span class="n">transitive</span> <span class="n">closure</span> <span class="n">of</span> <span class="err">`</span><span class="o">//</span><span class="n">foo</span><span class="err">`</span> <span class="n">that</span> <span class="n">directly</span> <span class="n">depend</span> <span class="n">on</span> <span class="err">`</span><span class="o">//</span><span class="n">common</span><span class="err">`</span><span class="o">.</span> <span class="p">(</span><span class="n">These</span>
</span></span><span class="line"><span class="cl"><span class="n">numbers</span> <span class="n">correspond</span> <span class="n">to</span> <span class="n">the</span> <span class="n">ranks</span> <span class="n">shown</span> <span class="ow">in</span> <span class="n">the</span> <span class="p">[</span><span class="err">`</span><span class="n">minrank</span><span class="err">`</span><span class="p">](</span><span class="c1">#output-ranked) output</span>
</span></span><span class="line"><span class="cl"><span class="nb">format</span><span class="o">.</span><span class="p">)</span> <span class="n">If</span> <span class="n">the</span> <span class="p">{{</span> <span class="s1">&#39;&lt;var&gt;&#39;</span> <span class="p">}}</span><span class="n">depth</span><span class="p">{{</span> <span class="s1">&#39;&lt;/var&gt;&#39;</span> <span class="p">}}</span> <span class="n">parameter</span> <span class="ow">is</span> <span class="n">omitted</span><span class="p">,</span> <span class="n">the</span>
</span></span><span class="line"><span class="cl"><span class="n">search</span> <span class="ow">is</span> <span class="n">unbounded</span><span class="o">.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">### Transitive closure of all reverse dependencies: allrdeps</span>
</span></span></code></pre></div><p>expr ::= allrdeps({{ &lsquo;<var>&rsquo; }}expr{{ &lsquo;</var>&rsquo; }})
| allrdeps({{ &lsquo;<var>&rsquo; }}expr{{ &lsquo;</var>&rsquo; }}, {{ &lsquo;<var>&rsquo; }}depth{{ &lsquo;</var>&rsquo; }})</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">Note: Only available with [Sky Query](#sky-query)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">The `allrdeps` operator behaves just like the [`rdeps`](#rdeps)
</span></span><span class="line"><span class="cl">operator, except that the &#34;universe set&#34; is whatever the `--universe_scope` flag
</span></span><span class="line"><span class="cl">evaluated to, instead of being separately specified. Thus, if
</span></span><span class="line"><span class="cl">`--universe_scope=//foo/...` was passed, then `allrdeps(//bar)` is
</span></span><span class="line"><span class="cl">equivalent to `rdeps(//foo/..., //bar)`.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">### Direct reverse dependencies in the same package: same_pkg_direct_rdeps
</span></span></code></pre></div><p>expr ::= same_pkg_direct_rdeps({{ &lsquo;<var>&rsquo; }}expr{{ &lsquo;</var>&rsquo; }})</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">The `same_pkg_direct_rdeps({{ &#39;&lt;var&gt;&#39; }}x{{ &#39;&lt;/var&gt;&#39; }})` operator evaluates to the full set of targets
</span></span><span class="line"><span class="cl">that are in the same package as a target in the argument set, and which directly depend on it.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">### Dealing with a target&#39;s package: siblings
</span></span></code></pre></div><p>expr ::= siblings({{ &lsquo;<var>&rsquo; }}expr{{ &lsquo;</var>&rsquo; }})</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">The `siblings({{ &#39;&lt;var&gt;&#39; }}x{{ &#39;&lt;/var&gt;&#39; }})` operator evaluates to the full set of targets that are in
</span></span><span class="line"><span class="cl">the same package as a target in the argument set.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">### Arbitrary choice: some
</span></span></code></pre></div><p>expr ::= some({{ &lsquo;<var>&rsquo; }}expr{{ &lsquo;</var>&rsquo; }})
| some({{ &lsquo;<var>&rsquo; }}expr{{ &lsquo;</var>&rsquo; }}, {{ &lsquo;<var>&rsquo; }}count{{ &lsquo;</var> &lsquo;}})</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">The</span> <span class="err">`</span><span class="n">some</span><span class="p">({{</span> <span class="s1">&#39;&lt;var&gt;&#39;</span> <span class="p">}}</span><span class="n">x</span><span class="p">{{</span> <span class="s1">&#39;&lt;/var&gt;&#39;</span> <span class="p">}},</span> <span class="p">{{</span> <span class="s1">&#39;&lt;var&gt;&#39;</span> <span class="p">}}</span><span class="n">k</span><span class="p">{{</span> <span class="s1">&#39;&lt;/var&gt;&#39;</span> <span class="p">}})</span><span class="err">`</span> <span class="n">operator</span>
</span></span><span class="line"><span class="cl"><span class="n">selects</span> <span class="n">at</span> <span class="n">most</span> <span class="p">{{</span> <span class="s1">&#39;&lt;var&gt;&#39;</span> <span class="p">}}</span><span class="n">k</span><span class="p">{{</span> <span class="s1">&#39;&lt;/var&gt;&#39;</span> <span class="p">}}</span> <span class="n">targets</span> <span class="n">arbitrarily</span> <span class="kn">from</span> <span class="nn">its</span>
</span></span><span class="line"><span class="cl"><span class="n">argument</span> <span class="nb">set</span> <span class="p">{{</span> <span class="s1">&#39;&lt;var&gt;&#39;</span> <span class="p">}}</span><span class="n">x</span><span class="p">{{</span> <span class="s1">&#39;&lt;/var&gt;&#39;</span> <span class="p">}},</span> <span class="ow">and</span> <span class="n">evaluates</span> <span class="n">to</span> <span class="n">a</span> <span class="nb">set</span> <span class="n">containing</span>
</span></span><span class="line"><span class="cl"><span class="n">only</span> <span class="n">those</span> <span class="n">targets</span><span class="o">.</span> <span class="n">Parameter</span> <span class="p">{{</span> <span class="s1">&#39;&lt;var&gt;&#39;</span> <span class="p">}}</span><span class="n">k</span><span class="p">{{</span> <span class="s1">&#39;&lt;/var&gt;&#39;</span> <span class="p">}}</span> <span class="ow">is</span> <span class="n">optional</span><span class="p">;</span> <span class="k">if</span>
</span></span><span class="line"><span class="cl"><span class="n">missing</span><span class="p">,</span> <span class="n">the</span> <span class="n">result</span> <span class="n">will</span> <span class="n">be</span> <span class="n">a</span> <span class="n">singleton</span> <span class="nb">set</span> <span class="n">containing</span> <span class="n">only</span> <span class="n">one</span> <span class="n">target</span>
</span></span><span class="line"><span class="cl"><span class="n">arbitrarily</span> <span class="n">selected</span><span class="o">.</span> <span class="n">If</span> <span class="n">the</span> <span class="n">size</span> <span class="n">of</span> <span class="n">argument</span> <span class="nb">set</span> <span class="p">{{</span> <span class="s1">&#39;&lt;var&gt;&#39;</span> <span class="p">}}</span><span class="n">x</span><span class="p">{{</span> <span class="s1">&#39;&lt;/var&gt;&#39;</span> <span class="p">}}</span> <span class="ow">is</span>
</span></span><span class="line"><span class="cl"><span class="n">smaller</span> <span class="n">than</span> <span class="p">{{</span> <span class="s1">&#39;&lt;var&gt;&#39;</span> <span class="p">}}</span><span class="n">k</span><span class="p">{{</span> <span class="s1">&#39;&lt;/var&gt;&#39;</span> <span class="p">}},</span> <span class="n">the</span> <span class="n">whole</span> <span class="n">argument</span> <span class="nb">set</span>
</span></span><span class="line"><span class="cl"><span class="p">{{</span> <span class="s1">&#39;&lt;var&gt;&#39;</span> <span class="p">}}</span><span class="n">x</span><span class="p">{{</span> <span class="s1">&#39;&lt;/var&gt;&#39;</span> <span class="p">}}</span> <span class="n">will</span> <span class="n">be</span> <span class="n">returned</span><span class="o">.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">For</span> <span class="n">example</span><span class="p">,</span> <span class="n">the</span> <span class="n">expression</span> <span class="err">`</span><span class="n">some</span><span class="p">(</span><span class="o">//</span><span class="n">foo</span><span class="p">:</span><span class="n">main</span> <span class="n">union</span> <span class="o">//</span><span class="n">bar</span><span class="p">:</span><span class="n">baz</span><span class="p">)</span><span class="err">`</span> <span class="n">evaluates</span> <span class="n">to</span> <span class="n">a</span>
</span></span><span class="line"><span class="cl"><span class="n">singleton</span> <span class="nb">set</span> <span class="n">containing</span> <span class="n">either</span> <span class="err">`</span><span class="o">//</span><span class="n">foo</span><span class="p">:</span><span class="n">main</span><span class="err">`</span> <span class="ow">or</span> <span class="err">`</span><span class="o">//</span><span class="n">bar</span><span class="p">:</span><span class="n">baz</span><span class="err">`</span><span class="n">though</span> <span class="n">which</span>
</span></span><span class="line"><span class="cl"><span class="n">one</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">defined</span><span class="o">.</span> <span class="n">The</span> <span class="n">expression</span> <span class="err">`</span><span class="n">some</span><span class="p">(</span><span class="o">//</span><span class="n">foo</span><span class="p">:</span><span class="n">main</span> <span class="n">union</span> <span class="o">//</span><span class="n">bar</span><span class="p">:</span><span class="n">baz</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="err">`</span> <span class="ow">or</span>
</span></span><span class="line"><span class="cl"><span class="err">`</span><span class="n">some</span><span class="p">(</span><span class="o">//</span><span class="n">foo</span><span class="p">:</span><span class="n">main</span> <span class="n">union</span> <span class="o">//</span><span class="n">bar</span><span class="p">:</span><span class="n">baz</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="err">`</span> <span class="n">returns</span> <span class="n">both</span> <span class="err">`</span><span class="o">//</span><span class="n">foo</span><span class="p">:</span><span class="n">main</span><span class="err">`</span> <span class="ow">and</span>
</span></span><span class="line"><span class="cl"><span class="err">`</span><span class="o">//</span><span class="n">bar</span><span class="p">:</span><span class="n">baz</span><span class="err">`</span><span class="o">.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">If</span> <span class="n">the</span> <span class="n">argument</span> <span class="ow">is</span> <span class="n">a</span> <span class="n">singleton</span><span class="p">,</span> <span class="n">then</span> <span class="err">`</span><span class="n">some</span><span class="err">`</span>
</span></span><span class="line"><span class="cl"><span class="n">computes</span> <span class="n">the</span> <span class="n">identity</span> <span class="n">function</span><span class="p">:</span> <span class="err">`</span><span class="n">some</span><span class="p">(</span><span class="o">//</span><span class="n">foo</span><span class="p">:</span><span class="n">main</span><span class="p">)</span><span class="err">`</span> <span class="ow">is</span>
</span></span><span class="line"><span class="cl"><span class="n">equivalent</span> <span class="n">to</span> <span class="err">`</span><span class="o">//</span><span class="n">foo</span><span class="p">:</span><span class="n">main</span><span class="err">`</span><span class="o">.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">It</span> <span class="ow">is</span> <span class="n">an</span> <span class="n">error</span> <span class="k">if</span> <span class="n">the</span> <span class="n">specified</span> <span class="n">argument</span> <span class="nb">set</span> <span class="ow">is</span> <span class="n">empty</span><span class="p">,</span> <span class="k">as</span> <span class="ow">in</span> <span class="n">the</span>
</span></span><span class="line"><span class="cl"><span class="n">expression</span> <span class="err">`</span><span class="n">some</span><span class="p">(</span><span class="o">//</span><span class="n">foo</span><span class="p">:</span><span class="n">main</span> <span class="n">intersect</span> <span class="o">//</span><span class="n">bar</span><span class="p">:</span><span class="n">baz</span><span class="p">)</span><span class="err">`</span><span class="o">.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">### Path operators: somepath, allpaths</span>
</span></span></code></pre></div><p>expr ::= somepath({{ &lsquo;<var>&rsquo; }}expr{{ &lsquo;</var>&rsquo; }}, {{ &lsquo;<var>&rsquo; }}expr{{ &lsquo;</var>&rsquo; }})
| allpaths({{ &lsquo;<var>&rsquo; }}expr{{ &lsquo;</var>&rsquo; }}, {{ &lsquo;<var>&rsquo; }}expr{{ &lsquo;</var>&rsquo; }})</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">The</span> <span class="err">`</span><span class="n">somepath</span><span class="p">({{</span> <span class="s1">&#39;&lt;var&gt;&#39;</span> <span class="p">}}</span><span class="n">S</span><span class="p">{{</span> <span class="s1">&#39;&lt;/var&gt;&#39;</span> <span class="p">}},</span> <span class="p">{{</span> <span class="s1">&#39;&lt;var&gt;&#39;</span> <span class="p">}}</span><span class="n">E</span><span class="p">{{</span> <span class="s1">&#39;&lt;/var&gt;&#39;</span> <span class="p">}})</span><span class="err">`</span> <span class="ow">and</span>
</span></span><span class="line"><span class="cl"><span class="err">`</span><span class="n">allpaths</span><span class="p">({{</span> <span class="s1">&#39;&lt;var&gt;&#39;</span> <span class="p">}}</span><span class="n">S</span><span class="p">{{</span> <span class="s1">&#39;&lt;/var&gt;&#39;</span> <span class="p">}},</span> <span class="p">{{</span> <span class="s1">&#39;&lt;var&gt;&#39;</span> <span class="p">}}</span><span class="n">E</span><span class="p">{{</span> <span class="s1">&#39;&lt;/var&gt;&#39;</span> <span class="p">}})</span><span class="err">`</span> <span class="n">operators</span> <span class="n">compute</span>
</span></span><span class="line"><span class="cl"><span class="n">paths</span> <span class="n">between</span> <span class="n">two</span> <span class="n">sets</span> <span class="n">of</span> <span class="n">targets</span><span class="o">.</span> <span class="n">Both</span> <span class="n">queries</span> <span class="n">accept</span> <span class="n">two</span>
</span></span><span class="line"><span class="cl"><span class="n">arguments</span><span class="p">,</span> <span class="n">a</span> <span class="nb">set</span> <span class="p">{{</span> <span class="s1">&#39;&lt;var&gt;&#39;</span> <span class="p">}}</span><span class="n">S</span><span class="p">{{</span> <span class="s1">&#39;&lt;/var&gt;&#39;</span> <span class="p">}}</span> <span class="n">of</span> <span class="n">starting</span> <span class="n">points</span> <span class="ow">and</span> <span class="n">a</span> <span class="nb">set</span>
</span></span><span class="line"><span class="cl"><span class="p">{{</span> <span class="s1">&#39;&lt;var&gt;&#39;</span> <span class="p">}}</span><span class="n">E</span><span class="p">{{</span> <span class="s1">&#39;&lt;/var&gt;&#39;</span> <span class="p">}}</span> <span class="n">of</span> <span class="n">ending</span> <span class="n">points</span><span class="o">.</span> <span class="err">`</span><span class="n">somepath</span><span class="err">`</span> <span class="n">returns</span> <span class="n">the</span>
</span></span><span class="line"><span class="cl"><span class="n">graph</span> <span class="n">of</span> <span class="n">nodes</span> <span class="n">on</span> <span class="n">_some_</span> <span class="n">arbitrary</span> <span class="n">path</span> <span class="kn">from</span> <span class="nn">a</span> <span class="n">target</span> <span class="ow">in</span>
</span></span><span class="line"><span class="cl"><span class="p">{{</span> <span class="s1">&#39;&lt;var&gt;&#39;</span> <span class="p">}}</span><span class="n">S</span><span class="p">{{</span> <span class="s1">&#39;&lt;/var&gt;&#39;</span> <span class="p">}}</span> <span class="n">to</span> <span class="n">a</span> <span class="n">target</span> <span class="ow">in</span> <span class="p">{{</span> <span class="s1">&#39;&lt;var&gt;&#39;</span> <span class="p">}}</span><span class="n">E</span><span class="p">{{</span> <span class="s1">&#39;&lt;/var&gt;&#39;</span> <span class="p">}};</span> <span class="err">`</span><span class="n">allpaths</span><span class="err">`</span>
</span></span><span class="line"><span class="cl"><span class="n">returns</span> <span class="n">the</span> <span class="n">graph</span> <span class="n">of</span> <span class="n">nodes</span> <span class="n">on</span> <span class="n">_all_</span> <span class="n">paths</span> <span class="kn">from</span> <span class="nn">any</span> <span class="n">target</span> <span class="ow">in</span>
</span></span><span class="line"><span class="cl"><span class="p">{{</span> <span class="s1">&#39;&lt;var&gt;&#39;</span> <span class="p">}}</span><span class="n">S</span><span class="p">{{</span> <span class="s1">&#39;&lt;/var&gt;&#39;</span> <span class="p">}}</span> <span class="n">to</span> <span class="nb">any</span> <span class="n">target</span> <span class="ow">in</span> <span class="p">{{</span> <span class="s1">&#39;&lt;var&gt;&#39;</span> <span class="p">}}</span><span class="n">E</span><span class="p">{{</span> <span class="s1">&#39;&lt;/var&gt;&#39;</span> <span class="p">}}</span><span class="o">.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">The</span> <span class="n">resulting</span> <span class="n">graphs</span> <span class="n">are</span> <span class="n">ordered</span> <span class="n">according</span> <span class="n">to</span> <span class="n">the</span> <span class="n">dependency</span> <span class="n">relation</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="n">See</span> <span class="n">the</span> <span class="n">section</span> <span class="n">on</span> <span class="p">[</span><span class="n">graph</span> <span class="n">order</span><span class="p">](</span><span class="c1">#graph-order) for more details.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">table</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="n">tr</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">td</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">figure</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="n">img</span> <span class="n">src</span><span class="o">=</span><span class="s2">&#34;/docs/images/somepath1.svg&#34;</span> <span class="n">alt</span><span class="o">=</span><span class="s2">&#34;Somepath&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="n">figcaption</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">somepath</span><span class="p">(</span><span class="n">S1</span> <span class="o">+</span> <span class="n">S2</span><span class="p">,</span> <span class="n">E</span><span class="p">)</span><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">one</span> <span class="n">possible</span> <span class="n">result</span><span class="o">.&lt;/</span><span class="n">figcaption</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;/</span><span class="n">figure</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">digraph</span> <span class="n">somepath1</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">graph</span> <span class="p">[</span><span class="n">size</span><span class="o">=</span><span class="s2">&#34;4,4&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">  <span class="n">node</span> <span class="p">[</span><span class="n">label</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="n">shape</span><span class="o">=</span><span class="n">circle</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="n">n1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">n2</span> <span class="p">[</span><span class="n">fillcolor</span><span class="o">=</span><span class="s2">&#34;pink&#34;</span><span class="p">,</span><span class="n">style</span><span class="o">=</span><span class="n">filled</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="n">n3</span> <span class="p">[</span><span class="n">fillcolor</span><span class="o">=</span><span class="s2">&#34;pink&#34;</span><span class="p">,</span><span class="n">style</span><span class="o">=</span><span class="n">filled</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="n">n4</span> <span class="p">[</span><span class="n">fillcolor</span><span class="o">=</span><span class="s2">&#34;pink&#34;</span><span class="p">,</span><span class="n">style</span><span class="o">=</span><span class="n">filled</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&#34;E&#34;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="n">n5</span><span class="p">;</span> <span class="n">n6</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">n7</span> <span class="p">[</span><span class="n">fillcolor</span><span class="o">=</span><span class="s2">&#34;pink&#34;</span><span class="p">,</span><span class="n">style</span><span class="o">=</span><span class="n">filled</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&#34;S1&#34;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="n">n8</span> <span class="p">[</span><span class="n">label</span><span class="o">=</span><span class="s2">&#34;S2&#34;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="n">n9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">n10</span> <span class="p">[</span><span class="n">fillcolor</span><span class="o">=</span><span class="s2">&#34;pink&#34;</span><span class="p">,</span><span class="n">style</span><span class="o">=</span><span class="n">filled</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="n">n1</span> <span class="o">-&gt;</span> <span class="n">n2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">n2</span> <span class="o">-&gt;</span> <span class="n">n3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">n7</span> <span class="o">-&gt;</span> <span class="n">n5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">n7</span> <span class="o">-&gt;</span> <span class="n">n2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">n5</span> <span class="o">-&gt;</span> <span class="n">n6</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">n6</span> <span class="o">-&gt;</span> <span class="n">n4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">n8</span> <span class="o">-&gt;</span> <span class="n">n6</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">n6</span> <span class="o">-&gt;</span> <span class="n">n9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">n2</span> <span class="o">-&gt;</span> <span class="n">n10</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">n3</span> <span class="o">-&gt;</span> <span class="n">n10</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">n10</span> <span class="o">-&gt;</span> <span class="n">n4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">n10</span> <span class="o">-&gt;</span> <span class="n">n11</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;/</span><span class="n">td</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">td</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">figure</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="n">img</span> <span class="n">src</span><span class="o">=</span><span class="s2">&#34;/docs/images/somepath2.svg&#34;</span> <span class="n">alt</span><span class="o">=</span><span class="s2">&#34;Somepath&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="n">figcaption</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">somepath</span><span class="p">(</span><span class="n">S1</span> <span class="o">+</span> <span class="n">S2</span><span class="p">,</span> <span class="n">E</span><span class="p">)</span><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">another</span> <span class="n">possible</span> <span class="n">result</span><span class="o">.&lt;/</span><span class="n">figcaption</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;/</span><span class="n">figure</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">digraph</span> <span class="n">somepath2</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">graph</span> <span class="p">[</span><span class="n">size</span><span class="o">=</span><span class="s2">&#34;4,4&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">  <span class="n">node</span> <span class="p">[</span><span class="n">label</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="n">shape</span><span class="o">=</span><span class="n">circle</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="n">n1</span><span class="p">;</span> <span class="n">n2</span><span class="p">;</span> <span class="n">n3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">n4</span> <span class="p">[</span><span class="n">fillcolor</span><span class="o">=</span><span class="s2">&#34;pink&#34;</span><span class="p">,</span><span class="n">style</span><span class="o">=</span><span class="n">filled</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&#34;E&#34;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="n">n5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">n6</span> <span class="p">[</span><span class="n">fillcolor</span><span class="o">=</span><span class="s2">&#34;pink&#34;</span><span class="p">,</span><span class="n">style</span><span class="o">=</span><span class="n">filled</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="n">n7</span> <span class="p">[</span><span class="n">label</span><span class="o">=</span><span class="s2">&#34;S1&#34;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="n">n8</span> <span class="p">[</span><span class="n">fillcolor</span><span class="o">=</span><span class="s2">&#34;pink&#34;</span><span class="p">,</span><span class="n">style</span><span class="o">=</span><span class="n">filled</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&#34;S2&#34;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="n">n9</span><span class="p">;</span> <span class="n">n10</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">n1</span> <span class="o">-&gt;</span> <span class="n">n2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">n2</span> <span class="o">-&gt;</span> <span class="n">n3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">n7</span> <span class="o">-&gt;</span> <span class="n">n5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">n7</span> <span class="o">-&gt;</span> <span class="n">n2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">n5</span> <span class="o">-&gt;</span> <span class="n">n6</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">n6</span> <span class="o">-&gt;</span> <span class="n">n4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">n8</span> <span class="o">-&gt;</span> <span class="n">n6</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">n6</span> <span class="o">-&gt;</span> <span class="n">n9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">n2</span> <span class="o">-&gt;</span> <span class="n">n10</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">n3</span> <span class="o">-&gt;</span> <span class="n">n10</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">n10</span> <span class="o">-&gt;</span> <span class="n">n4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">n10</span> <span class="o">-&gt;</span> <span class="n">n11</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;/</span><span class="n">td</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">td</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">figure</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="n">img</span> <span class="n">src</span><span class="o">=</span><span class="s2">&#34;/docs/images/allpaths.svg&#34;</span> <span class="n">alt</span><span class="o">=</span><span class="s2">&#34;Allpaths&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="n">figcaption</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">allpaths</span><span class="p">(</span><span class="n">S1</span> <span class="o">+</span> <span class="n">S2</span><span class="p">,</span> <span class="n">E</span><span class="p">)</span><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">figcaption</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;/</span><span class="n">figure</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">digraph</span> <span class="n">allpaths</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">graph</span> <span class="p">[</span><span class="n">size</span><span class="o">=</span><span class="s2">&#34;4,4&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">  <span class="n">node</span> <span class="p">[</span><span class="n">label</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="n">shape</span><span class="o">=</span><span class="n">circle</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="n">n1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">n2</span> <span class="p">[</span><span class="n">fillcolor</span><span class="o">=</span><span class="s2">&#34;pink&#34;</span><span class="p">,</span><span class="n">style</span><span class="o">=</span><span class="n">filled</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="n">n3</span> <span class="p">[</span><span class="n">fillcolor</span><span class="o">=</span><span class="s2">&#34;pink&#34;</span><span class="p">,</span><span class="n">style</span><span class="o">=</span><span class="n">filled</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="n">n4</span> <span class="p">[</span><span class="n">fillcolor</span><span class="o">=</span><span class="s2">&#34;pink&#34;</span><span class="p">,</span><span class="n">style</span><span class="o">=</span><span class="n">filled</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&#34;E&#34;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="n">n5</span> <span class="p">[</span><span class="n">fillcolor</span><span class="o">=</span><span class="s2">&#34;pink&#34;</span><span class="p">,</span><span class="n">style</span><span class="o">=</span><span class="n">filled</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="n">n6</span> <span class="p">[</span><span class="n">fillcolor</span><span class="o">=</span><span class="s2">&#34;pink&#34;</span><span class="p">,</span><span class="n">style</span><span class="o">=</span><span class="n">filled</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="n">n7</span> <span class="p">[</span><span class="n">fillcolor</span><span class="o">=</span><span class="s2">&#34;pink&#34;</span><span class="p">,</span><span class="n">style</span><span class="o">=</span><span class="n">filled</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&#34;S1&#34;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="n">n8</span> <span class="p">[</span><span class="n">fillcolor</span><span class="o">=</span><span class="s2">&#34;pink&#34;</span><span class="p">,</span><span class="n">style</span><span class="o">=</span><span class="n">filled</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&#34;S2&#34;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="n">n9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">n10</span> <span class="p">[</span><span class="n">fillcolor</span><span class="o">=</span><span class="s2">&#34;pink&#34;</span><span class="p">,</span><span class="n">style</span><span class="o">=</span><span class="n">filled</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="n">n1</span> <span class="o">-&gt;</span> <span class="n">n2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">n2</span> <span class="o">-&gt;</span> <span class="n">n3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">n7</span> <span class="o">-&gt;</span> <span class="n">n5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">n7</span> <span class="o">-&gt;</span> <span class="n">n2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">n5</span> <span class="o">-&gt;</span> <span class="n">n6</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">n6</span> <span class="o">-&gt;</span> <span class="n">n4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">n8</span> <span class="o">-&gt;</span> <span class="n">n6</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">n6</span> <span class="o">-&gt;</span> <span class="n">n9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">n2</span> <span class="o">-&gt;</span> <span class="n">n10</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">n3</span> <span class="o">-&gt;</span> <span class="n">n10</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">n10</span> <span class="o">-&gt;</span> <span class="n">n4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">n10</span> <span class="o">-&gt;</span> <span class="n">n11</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;/</span><span class="n">td</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;/</span><span class="n">tr</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;/</span><span class="n">table</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">### Target kind filtering: kind</span>
</span></span></code></pre></div><p>expr ::= kind({{ &lsquo;<var>&rsquo; }}word{{ &lsquo;</var>&rsquo; }}, {{ &lsquo;<var>&rsquo; }}expr{{ &lsquo;</var>&rsquo; }})</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">The `kind({{ &#39;&lt;var&gt;&#39; }}pattern{{ &#39;&lt;/var&gt;&#39; }}, {{ &#39;&lt;var&gt;&#39; }}input{{ &#39;&lt;/var&gt;&#39; }})`
</span></span><span class="line"><span class="cl">operator applies a filter to a set of targets, and discards those targets
</span></span><span class="line"><span class="cl">that are not of the expected kind. The {{ &#39;&lt;var&gt;&#39; }}pattern{{ &#39;&lt;/var&gt;&#39; }}
</span></span><span class="line"><span class="cl">parameter specifies what kind of target to match.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">For example, the kinds for the four targets defined by the `BUILD` file
</span></span><span class="line"><span class="cl">(for package `p`) shown below are illustrated in the table:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&lt;table&gt;
</span></span><span class="line"><span class="cl">  &lt;tr&gt;
</span></span><span class="line"><span class="cl">    &lt;th&gt;Code&lt;/th&gt;
</span></span><span class="line"><span class="cl">    &lt;th&gt;Target&lt;/th&gt;
</span></span><span class="line"><span class="cl">    &lt;th&gt;Kind&lt;/th&gt;
</span></span><span class="line"><span class="cl">  &lt;/tr&gt;
</span></span><span class="line"><span class="cl">  &lt;tr&gt;
</span></span><span class="line"><span class="cl">    &lt;td rowspan=&#34;4&#34;&gt;
</span></span><span class="line"><span class="cl">      &lt;pre&gt;
</span></span><span class="line"><span class="cl">        genrule(
</span></span><span class="line"><span class="cl">            name = &#34;a&#34;,
</span></span><span class="line"><span class="cl">            srcs = [&#34;a.in&#34;],
</span></span><span class="line"><span class="cl">            outs = [&#34;a.out&#34;],
</span></span><span class="line"><span class="cl">            cmd = &#34;...&#34;,
</span></span><span class="line"><span class="cl">        )
</span></span><span class="line"><span class="cl">      &lt;/pre&gt;
</span></span><span class="line"><span class="cl">    &lt;/td&gt;
</span></span><span class="line"><span class="cl">    &lt;td&gt;&lt;code&gt;//p:a&lt;/code&gt;&lt;/td&gt;
</span></span><span class="line"><span class="cl">    &lt;td&gt;genrule rule&lt;/td&gt;
</span></span><span class="line"><span class="cl">  &lt;/tr&gt;
</span></span><span class="line"><span class="cl">  &lt;tr&gt;
</span></span><span class="line"><span class="cl">    &lt;td&gt;&lt;code&gt;//p:a.in&lt;/code&gt;&lt;/td&gt;
</span></span><span class="line"><span class="cl">    &lt;td&gt;source file&lt;/td&gt;
</span></span><span class="line"><span class="cl">  &lt;/tr&gt;
</span></span><span class="line"><span class="cl">  &lt;tr&gt;
</span></span><span class="line"><span class="cl">    &lt;td&gt;&lt;code&gt;//p:a.out&lt;/code&gt;&lt;/td&gt;
</span></span><span class="line"><span class="cl">    &lt;td&gt;generated file&lt;/td&gt;
</span></span><span class="line"><span class="cl">  &lt;/tr&gt;
</span></span><span class="line"><span class="cl">  &lt;tr&gt;
</span></span><span class="line"><span class="cl">    &lt;td&gt;&lt;code&gt;//p:BUILD&lt;/code&gt;&lt;/td&gt;
</span></span><span class="line"><span class="cl">    &lt;td&gt;source file&lt;/td&gt;
</span></span><span class="line"><span class="cl">  &lt;/tr&gt;
</span></span><span class="line"><span class="cl">&lt;/table&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Thus, `kind(&#34;cc_.* rule&#34;, foo/...)` evaluates to the set
</span></span><span class="line"><span class="cl">of all `cc_library`, `cc_binary`, etc,
</span></span><span class="line"><span class="cl">rule targets beneath `foo`, and `kind(&#34;source file&#34;, deps(//foo))`
</span></span><span class="line"><span class="cl">evaluates to the set of all source files in the transitive closure
</span></span><span class="line"><span class="cl">of dependencies of the `//foo` target.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Quotation of the {{ &#39;&lt;var&gt;&#39; }}pattern{{ &#39;&lt;/var&gt;&#39; }} argument is often required
</span></span><span class="line"><span class="cl">because without it, many [regular expressions](#regex), such as `source
</span></span><span class="line"><span class="cl">file` and `.*_test`, are not considered words by the parser.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">When matching for `package group`, targets ending in
</span></span><span class="line"><span class="cl">`:all` may not yield any results. Use `:all-targets` instead.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">### Target name filtering: filter
</span></span></code></pre></div><p>expr ::= filter({{ &lsquo;<var>&rsquo; }}word{{ &lsquo;</var>&rsquo; }}, {{ &lsquo;<var>&rsquo; }}expr{{ &lsquo;</var>&rsquo; }})</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">The `filter({{ &#39;&lt;var&gt;&#39; }}pattern{{ &#39;&lt;/var&gt;&#39; }}, {{ &#39;&lt;var&gt;&#39; }}input{{ &#39;&lt;/var&gt;&#39; }})`
</span></span><span class="line"><span class="cl">operator applies a filter to a set of targets, and discards targets whose
</span></span><span class="line"><span class="cl">labels (in absolute form) do not match the pattern; it
</span></span><span class="line"><span class="cl">evaluates to a subset of its input.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">The first argument, {{ &#39;&lt;var&gt;&#39; }}pattern{{ &#39;&lt;/var&gt;&#39; }} is a word containing a
</span></span><span class="line"><span class="cl">[regular expression](#regex) over target names. A `filter` expression
</span></span><span class="line"><span class="cl">evaluates to the set containing all targets {{ &#39;&lt;var&gt;&#39; }}x{{ &#39;&lt;/var&gt;&#39; }} such that
</span></span><span class="line"><span class="cl">{{ &#39;&lt;var&gt;&#39; }}x{{ &#39;&lt;/var&gt;&#39; }} is a member of the set {{ &#39;&lt;var&gt;&#39; }}input{{ &#39;&lt;/var&gt;&#39; }} and the
</span></span><span class="line"><span class="cl">label (in absolute form, such as `//foo:bar`)
</span></span><span class="line"><span class="cl">of {{ &#39;&lt;var&gt;&#39; }}x{{ &#39;&lt;/var&gt;&#39; }} contains an (unanchored) match
</span></span><span class="line"><span class="cl">for the regular expression {{ &#39;&lt;var&gt;&#39; }}pattern{{ &#39;&lt;/var&gt;&#39; }}. Since all
</span></span><span class="line"><span class="cl">target names start with `//`, it may be used as an alternative
</span></span><span class="line"><span class="cl">to the `^` regular expression anchor.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">This operator often provides a much faster and more robust alternative to the
</span></span><span class="line"><span class="cl">`intersect` operator. For example, in order to see all
</span></span><span class="line"><span class="cl">`bar` dependencies of the `//foo:foo` target, one could
</span></span><span class="line"><span class="cl">evaluate
</span></span></code></pre></div><p>deps(//foo) intersect //bar/&hellip;</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">This statement, however, will require parsing of all `BUILD` files in the
</span></span><span class="line"><span class="cl">`bar` tree, which will be slow and prone to errors in
</span></span><span class="line"><span class="cl">irrelevant `BUILD` files. An alternative would be:
</span></span></code></pre></div><p>filter(//bar, deps(//foo))</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">which would first calculate the set of `//foo` dependencies and
</span></span><span class="line"><span class="cl">then would filter only targets matching the provided patternin other
</span></span><span class="line"><span class="cl">words, targets with names containing `//bar` as a substring.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Another common use of the `filter({{ &#39;&lt;var&gt;&#39; }}pattern{{ &#39;&lt;/var&gt;&#39; }},
</span></span><span class="line"><span class="cl">{{ &#39;&lt;var&gt;&#39; }}expr{{ &#39;&lt;/var&gt;&#39; }})` operator is to filter specific files by their
</span></span><span class="line"><span class="cl">name or extension. For example,
</span></span></code></pre></div><p>filter(&rdquo;.cc$&quot;, deps(//foo))</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">will provide a list of all `.cc` files used to build `//foo`.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">### Rule attribute filtering: attr
</span></span></code></pre></div><p>expr ::= attr({{ &lsquo;<var>&rsquo; }}word{{ &lsquo;</var>&rsquo; }}, {{ &lsquo;<var>&rsquo; }}word{{ &lsquo;</var>&rsquo; }}, {{ &lsquo;<var>&rsquo; }}expr{{ &lsquo;</var>&rsquo; }})</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">The
</span></span><span class="line"><span class="cl">`attr({{ &#39;&lt;var&gt;&#39; }}name{{ &#39;&lt;/var&gt;&#39; }}, {{ &#39;&lt;var&gt;&#39; }}pattern{{ &#39;&lt;/var&gt;&#39; }}, {{ &#39;&lt;var&gt;&#39; }}input{{ &#39;&lt;/var&gt;&#39; }})`
</span></span><span class="line"><span class="cl">operator applies a filter to a set of targets, and discards targets that aren&#39;t
</span></span><span class="line"><span class="cl">rules, rule targets that do not have attribute {{ &#39;&lt;var&gt;&#39; }}name{{ &#39;&lt;/var&gt;&#39; }}
</span></span><span class="line"><span class="cl">defined or rule targets where the attribute value does not match the provided
</span></span><span class="line"><span class="cl">[regular expression](#regex) {{ &#39;&lt;var&gt;&#39; }}pattern{{ &#39;&lt;/var&gt;&#39; }}; it evaluates
</span></span><span class="line"><span class="cl">to a subset of its input.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">The first argument, {{ &#39;&lt;var&gt;&#39; }}name{{ &#39;&lt;/var&gt;&#39; }} is the name of the rule
</span></span><span class="line"><span class="cl">attribute that should be matched against the provided
</span></span><span class="line"><span class="cl">[regular expression](#regex) pattern. The second argument,
</span></span><span class="line"><span class="cl">{{ &#39;&lt;var&gt;&#39; }}pattern{{ &#39;&lt;/var&gt;&#39; }} is a regular expression over the attribute
</span></span><span class="line"><span class="cl">values. An `attr` expression evaluates to the set containing all targets
</span></span><span class="line"><span class="cl">{{ &#39;&lt;var&gt;&#39; }}x{{ &#39;&lt;/var&gt;&#39; }} such that  {{ &#39;&lt;var&gt;&#39; }}x{{ &#39;&lt;/var&gt;&#39; }} is a
</span></span><span class="line"><span class="cl">member of the set {{ &#39;&lt;var&gt;&#39; }}input{{ &#39;&lt;/var&gt;&#39; }}, is a rule with the defined
</span></span><span class="line"><span class="cl">attribute {{ &#39;&lt;var&gt;&#39; }}name{{ &#39;&lt;/var&gt;&#39; }} and the attribute value contains an
</span></span><span class="line"><span class="cl">(unanchored) match for the regular expression
</span></span><span class="line"><span class="cl">{{ &#39;&lt;var&gt;&#39; }}pattern{{ &#39;&lt;/var&gt;&#39; }}. If {{ &#39;&lt;var&gt;&#39; }}name{{ &#39;&lt;/var&gt;&#39; }} is an
</span></span><span class="line"><span class="cl">optional attribute and rule does not specify it explicitly then default
</span></span><span class="line"><span class="cl">attribute value will be used for comparison. For example,
</span></span></code></pre></div><p>attr(linkshared, 0, deps(//foo))</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">will select all `//foo` dependencies that are allowed to have a
</span></span><span class="line"><span class="cl">linkshared attribute (such as, `cc_binary` rule) and have it either
</span></span><span class="line"><span class="cl">explicitly set to 0 or do not set it at all but default value is 0 (such as for
</span></span><span class="line"><span class="cl">`cc_binary` rules).
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">List-type attributes (such as `srcs`, `data`, etc) are
</span></span><span class="line"><span class="cl">converted to strings of the form `[value&lt;sub&gt;1&lt;/sub&gt;, ..., value&lt;sub&gt;n&lt;/sub&gt;]`,
</span></span><span class="line"><span class="cl">starting with a `[` bracket, ending with a `]` bracket
</span></span><span class="line"><span class="cl">and using &#34;`, `&#34; (comma, space) to delimit multiple values.
</span></span><span class="line"><span class="cl">Labels are converted to strings by using the absolute form of the
</span></span><span class="line"><span class="cl">label. For example, an attribute `deps=[&#34;:foo&#34;,
</span></span><span class="line"><span class="cl">&#34;//otherpkg:bar&#34;, &#34;wiz&#34;]` would be converted to the
</span></span><span class="line"><span class="cl">string `[//thispkg:foo, //otherpkg:bar, //thispkg:wiz]`.
</span></span><span class="line"><span class="cl">Brackets are always present, so the empty list would use string value `[]`
</span></span><span class="line"><span class="cl">for matching purposes. For example,
</span></span></code></pre></div><p>attr(&ldquo;srcs&rdquo;, &ldquo;[]&rdquo;, deps(//foo))</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">will select all rules among `//foo` dependencies that have an
</span></span><span class="line"><span class="cl">empty `srcs` attribute, while
</span></span></code></pre></div><p>attr(&ldquo;data&rdquo;, &ldquo;.{3,}&rdquo;, deps(//foo))</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">will select all rules among `//foo` dependencies that specify at
</span></span><span class="line"><span class="cl">least one value in the `data` attribute (every label is at least
</span></span><span class="line"><span class="cl">3 characters long due to the `//` and `:`).
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">To select all rules among `//foo` dependencies with a particular `value` in a
</span></span><span class="line"><span class="cl">list-type attribute, use
</span></span></code></pre></div><p>attr(&ldquo;tags&rdquo;, &ldquo;[[ ]value[,]]&rdquo;, deps(//foo))</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">This works because the character before `value` will be `[` or a space and the
</span></span><span class="line"><span class="cl">character after `value` will be a comma or `]`.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">To select all rules among `//foo` dependencies with a particular `key` and
</span></span><span class="line"><span class="cl">`value` in a dict-type attribute, use
</span></span></code></pre></div><p>attr(&ldquo;some_dict_attribute&rdquo;, &ldquo;[{ ]key=value[,}]&rdquo;, deps(//foo))</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">This would select `//foo` if `//foo` is defined as
</span></span></code></pre></div><p>some_rule(
name = &ldquo;foo&rdquo;,
some_dict_attribute = {
&ldquo;key&rdquo;: &ldquo;value&rdquo;,
},
)</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">This works because the character before `key=value` will be `{` or a space and
</span></span><span class="line"><span class="cl">the character after `key=value` will be a comma or `}`.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">### Rule visibility filtering: visible
</span></span></code></pre></div><p>expr ::= visible({{ &lsquo;<var>&rsquo; }}expr{{ &lsquo;</var>&rsquo; }}, {{ &lsquo;<var>&rsquo; }}expr{{ &lsquo;</var>&rsquo; }})</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">The `visible({{ &#39;&lt;var&gt;&#39; }}predicate{{ &#39;&lt;/var&gt;&#39; }}, {{ &#39;&lt;var&gt;&#39; }}input{{ &#39;&lt;/var&gt;&#39; }})` operator
</span></span><span class="line"><span class="cl">applies a filter to a set of targets, and discards targets without the
</span></span><span class="line"><span class="cl">required visibility.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">The first argument, {{ &#39;&lt;var&gt;&#39; }}predicate{{ &#39;&lt;/var&gt;&#39; }}, is a set of targets that all targets
</span></span><span class="line"><span class="cl">in the output must be visible to. A {{ &#39;&lt;var&gt;&#39; }}visible{{ &#39;&lt;/var&gt;&#39; }} expression
</span></span><span class="line"><span class="cl">evaluates to the set containing all targets {{ &#39;&lt;var&gt;&#39; }}x{{ &#39;&lt;/var&gt;&#39; }} such that {{ &#39;&lt;var&gt;&#39; }}x{{ &#39;&lt;/var&gt;&#39; }}
</span></span><span class="line"><span class="cl">is a member of the set {{ &#39;&lt;var&gt;&#39; }}input{{ &#39;&lt;/var&gt;&#39; }}, and for all targets {{ &#39;&lt;var&gt;&#39; }}y{{ &#39;&lt;/var&gt;&#39; }} in
</span></span><span class="line"><span class="cl">{{ &#39;&lt;var&gt;&#39; }}predicate{{ &#39;&lt;/var&gt;&#39; }} {{ &#39;&lt;var&gt;&#39; }}x{{ &#39;&lt;/var&gt;&#39; }} is visible to {{ &#39;&lt;var&gt;&#39; }}y{{ &#39;&lt;/var&gt;&#39; }}. For example:
</span></span></code></pre></div><p>visible(//foo, //bar:*)</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">will select all targets in the package `//bar` that `//foo`
</span></span><span class="line"><span class="cl">can depend on without violating visibility restrictions.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">### Evaluation of rule attributes of type label: labels
</span></span></code></pre></div><p>expr ::= labels({{ &lsquo;<var>&rsquo; }}word{{ &lsquo;</var>&rsquo; }}, {{ &lsquo;<var>&rsquo; }}expr{{ &lsquo;</var>&rsquo; }})</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">The `labels({{ &#39;&lt;var&gt;&#39; }}attr_name{{ &#39;&lt;/var&gt;&#39; }}, {{ &#39;&lt;var&gt;&#39; }}inputs{{ &#39;&lt;/var&gt;&#39; }})`
</span></span><span class="line"><span class="cl">operator returns the set of targets specified in the
</span></span><span class="line"><span class="cl">attribute {{ &#39;&lt;var&gt;&#39; }}attr_name{{ &#39;&lt;/var&gt;&#39; }} of type &#34;label&#34; or &#34;list of label&#34; in
</span></span><span class="line"><span class="cl">some rule in set {{ &#39;&lt;var&gt;&#39; }}inputs{{ &#39;&lt;/var&gt;&#39; }}.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">For example, `labels(srcs, //foo)` returns the set of
</span></span><span class="line"><span class="cl">targets appearing in the `srcs` attribute of
</span></span><span class="line"><span class="cl">the `//foo` rule. If there are multiple rules
</span></span><span class="line"><span class="cl">with `srcs` attributes in the {{ &#39;&lt;var&gt;&#39; }}inputs{{ &#39;&lt;/var&gt;&#39; }} set, the
</span></span><span class="line"><span class="cl">union of their `srcs` is returned.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">### Expand and filter test_suites: tests
</span></span></code></pre></div><p>expr ::= tests({{ &lsquo;<var>&rsquo; }}expr{{ &lsquo;</var>&rsquo; }})</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">The `tests({{ &#39;&lt;var&gt;&#39; }}x{{ &#39;&lt;/var&gt;&#39; }})` operator returns the set of all test
</span></span><span class="line"><span class="cl">rules in set {{ &#39;&lt;var&gt;&#39; }}x{{ &#39;&lt;/var&gt;&#39; }}, expanding any `test_suite` rules into
</span></span><span class="line"><span class="cl">the set of individual tests that they refer to, and applying filtering by
</span></span><span class="line"><span class="cl">`tag` and `size`.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">By default, query evaluation
</span></span><span class="line"><span class="cl">ignores any non-test targets in all `test_suite` rules. This can be
</span></span><span class="line"><span class="cl">changed to errors with the `--strict_test_suite` option.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">For example, the query `kind(test, foo:*)` lists all
</span></span><span class="line"><span class="cl">the `*_test` and `test_suite` rules
</span></span><span class="line"><span class="cl">in the `foo` package. All the results are (by
</span></span><span class="line"><span class="cl">definition) members of the `foo` package. In contrast,
</span></span><span class="line"><span class="cl">the query `tests(foo:*)` will return all of the
</span></span><span class="line"><span class="cl">individual tests that would be executed by `bazel test
</span></span><span class="line"><span class="cl">foo:*`: this may include tests belonging to other packages,
</span></span><span class="line"><span class="cl">that are referenced directly or indirectly
</span></span><span class="line"><span class="cl">via `test_suite` rules.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">### Package definition files: buildfiles
</span></span></code></pre></div><p>expr ::= buildfiles({{ &lsquo;<var>&rsquo; }}expr{{ &lsquo;</var>&rsquo; }})</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">The `buildfiles({{ &#39;&lt;var&gt;&#39; }}x{{ &#39;&lt;/var&gt;&#39; }})` operator returns the set
</span></span><span class="line"><span class="cl">of files that define the packages of each target in
</span></span><span class="line"><span class="cl">set {{ &#39;&lt;var&gt;&#39; }}x{{ &#39;&lt;/var&gt;&#39; }}; in other words, for each package, its `BUILD` file,
</span></span><span class="line"><span class="cl">plus any .bzl files it references via `load`. Note that this
</span></span><span class="line"><span class="cl">also returns the `BUILD` files of the packages containing these
</span></span><span class="line"><span class="cl">`load`ed files.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">This operator is typically used when determining what files or
</span></span><span class="line"><span class="cl">packages are required to build a specified target, often in conjunction with
</span></span><span class="line"><span class="cl">the [`--output package`](#output-package) option, below). For example,
</span></span></code></pre></div><p>bazel query &lsquo;buildfiles(deps(//foo))&rsquo; &ndash;output package</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="n">returns</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="kt">set</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="k">all</span><span class="w"> </span><span class="n">packages</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="o">`//</span><span class="n">foo</span><span class="o">`</span><span class="w"> </span><span class="n">transitively</span><span class="w"> </span><span class="n">depends</span><span class="p">.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Note</span><span class="p">:</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="n">naive</span><span class="w"> </span><span class="n">attempt</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">above</span><span class="w"> </span><span class="n">query</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="n">omit</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">the</span><span class="w"> </span><span class="o">`</span><span class="n">buildfiles</span><span class="o">`</span><span class="w"> </span><span class="n">operator</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="k">use</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="o">`</span><span class="n">deps</span><span class="o">`</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">but</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">yields</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">incorrect</span><span class="w"> </span><span class="n">result</span><span class="p">:</span><span class="w"> </span><span class="k">while</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="n">contains</span><span class="w"> </span><span class="n">the</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">majority</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">needed</span><span class="w"> </span><span class="n">packages</span><span class="p">,</span><span class="w"> </span><span class="n">those</span><span class="w"> </span><span class="n">packages</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">contain</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">files</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">that</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="o">`</span><span class="k">load</span><span class="p">()</span><span class="o">`</span><span class="s1">&#39;ed will be missing.
</span></span></span><span class="line"><span class="cl"><span class="s1">
</span></span></span><span class="line"><span class="cl"><span class="s1">Warning: Bazel pretends each `.bzl` file produced by
</span></span></span><span class="line"><span class="cl"><span class="s1">`buildfiles` has a corresponding target (for example, file `a/b.bzl` =&gt;
</span></span></span><span class="line"><span class="cl"><span class="s1">target `//a:b.bzl`), but this isn&#39;</span><span class="n">t</span><span class="w"> </span><span class="n">necessarily</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">case</span><span class="p">.</span><span class="w"> </span><span class="n">Therefore</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">`</span><span class="n">buildfiles</span><span class="o">`</span><span class="w"> </span><span class="n">doesn</span><span class="s1">&#39;t compose well with other query operators and its results can be
</span></span></span><span class="line"><span class="cl"><span class="s1">misleading when formatted in a structured way, such as
</span></span></span><span class="line"><span class="cl"><span class="s1">[`--output=xml`](#xml).
</span></span></span><span class="line"><span class="cl"><span class="s1">
</span></span></span><span class="line"><span class="cl"><span class="s1">### Package definition files: rbuildfiles
</span></span></span></code></pre></div><p>expr ::= rbuildfiles({{ &lsquo;<var>&rsquo; }}word{{ &lsquo;</var>&rsquo; }}, &hellip;)</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="n">Note</span><span class="p">:</span><span class="w"> </span><span class="n">Only</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="p">[</span><span class="n">Sky</span><span class="w"> </span><span class="n">Query</span><span class="p">](</span><span class="c1">#sky-query).
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">The</span><span class="w"> </span><span class="o">`</span><span class="n">rbuildfiles</span><span class="o">`</span><span class="w"> </span><span class="n">operator</span><span class="w"> </span><span class="n">takes</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">comma</span><span class="o">-</span><span class="n">separated</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="n">fragments</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">returns</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">the</span><span class="w"> </span><span class="kt">set</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="o">`</span><span class="n">BUILD</span><span class="o">`</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">transitively</span><span class="w"> </span><span class="n">depend</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">these</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="n">fragments</span><span class="p">.</span><span class="w"> </span><span class="k">For</span><span class="w"> </span><span class="n">instance</span><span class="p">,</span><span class="w"> </span><span class="k">if</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">`//</span><span class="n">foo</span><span class="o">`</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">package</span><span class="p">,</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="o">`</span><span class="nf">rbuildfiles</span><span class="p">(</span><span class="n">foo</span><span class="o">/</span><span class="n">BUILD</span><span class="p">)</span><span class="o">`</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">the</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">`//</span><span class="n">foo</span><span class="p">:</span><span class="n">BUILD</span><span class="o">`</span><span class="w"> </span><span class="n">target</span><span class="p">.</span><span class="w"> </span><span class="k">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">`</span><span class="n">foo</span><span class="o">/</span><span class="n">BUILD</span><span class="o">`</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">has</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">`</span><span class="k">load</span><span class="p">(</span><span class="s1">&#39;//bar:file.bzl&#39;</span><span class="p">...</span><span class="o">`</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">it</span><span class="p">,</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="o">`</span><span class="nf">rbuildfiles</span><span class="p">(</span><span class="n">bar</span><span class="o">/</span><span class="n">file</span><span class="p">.</span><span class="n">bzl</span><span class="p">)</span><span class="o">`</span><span class="w"> </span><span class="n">will</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">return</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">`//</span><span class="n">foo</span><span class="p">:</span><span class="n">BUILD</span><span class="o">`</span><span class="w"> </span><span class="n">target</span><span class="p">,</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">well</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">targets</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="o">`</span><span class="n">BUILD</span><span class="o">`</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="n">that</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">load</span><span class="w"> </span><span class="o">`//</span><span class="n">bar</span><span class="p">:</span><span class="n">file</span><span class="p">.</span><span class="n">bzl</span><span class="o">`</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">The</span><span class="w"> </span><span class="n">scope</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">&lt;</span><span class="n">scope</span><span class="o">&gt;</span><span class="n">rbuildfiles</span><span class="o">&lt;/</span><span class="n">scope</span><span class="o">&gt;</span><span class="w"> </span><span class="n">operator</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">universe</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">the</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">`--</span><span class="n">universe_scope</span><span class="o">`</span><span class="w"> </span><span class="n">flag</span><span class="p">.</span><span class="w"> </span><span class="n">Files</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">do</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="n">correspond</span><span class="w"> </span><span class="n">directly</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="o">`</span><span class="n">BUILD</span><span class="o">`</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="o">`</span><span class="p">.</span><span class="n">bzl</span><span class="o">`</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">files</span><span class="w"> </span><span class="n">do</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="n">affect</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">results</span><span class="p">.</span><span class="w"> </span><span class="k">For</span><span class="w"> </span><span class="n">instance</span><span class="p">,</span><span class="w"> </span><span class="n">source</span><span class="w"> </span><span class="nf">files</span><span class="w"> </span><span class="p">(</span><span class="k">like</span><span class="w"> </span><span class="o">`</span><span class="n">foo</span><span class="p">.</span><span class="n">cc</span><span class="o">`</span><span class="p">)</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">ignored</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">even</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">they</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">explicitly</span><span class="w"> </span><span class="n">mentioned</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">`</span><span class="n">BUILD</span><span class="o">`</span><span class="w"> </span><span class="n">file</span><span class="p">.</span><span class="w"> </span><span class="n">Symlinks</span><span class="p">,</span><span class="w"> </span><span class="n">however</span><span class="p">,</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">respected</span><span class="p">,</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">that</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">if</span><span class="w"> </span><span class="o">`</span><span class="n">foo</span><span class="o">/</span><span class="n">BUILD</span><span class="o">`</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">symlink</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="o">`</span><span class="n">bar</span><span class="o">/</span><span class="n">BUILD</span><span class="o">`</span><span class="p">,</span><span class="w"> </span><span class="k">then</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">`</span><span class="nf">rbuildfiles</span><span class="p">(</span><span class="n">bar</span><span class="o">/</span><span class="n">BUILD</span><span class="p">)</span><span class="o">`</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">include</span><span class="w"> </span><span class="o">`//</span><span class="n">foo</span><span class="p">:</span><span class="n">BUILD</span><span class="o">`</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">its</span><span class="w"> </span><span class="n">results</span><span class="p">.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">The</span><span class="w"> </span><span class="o">`</span><span class="n">rbuildfiles</span><span class="o">`</span><span class="w"> </span><span class="n">operator</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">almost</span><span class="w"> </span><span class="n">morally</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">inverse</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">[</span><span class="o">`</span><span class="n">buildfiles</span><span class="o">`</span><span class="p">](</span><span class="c1">#buildfiles) operator. However, this moral inversion
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">holds</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">strongly</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">direction</span><span class="p">:</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">outputs</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="o">`</span><span class="n">rbuildfiles</span><span class="o">`</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">just</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="n">the</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">inputs</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="o">`</span><span class="n">buildfiles</span><span class="o">`</span><span class="p">;</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">former</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">contain</span><span class="w"> </span><span class="o">`</span><span class="n">BUILD</span><span class="o">`</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">targets</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">packages</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">latter</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">contain</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">targets</span><span class="p">.</span><span class="w"> </span><span class="k">In</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">direction</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">correspondence</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">weaker</span><span class="p">.</span><span class="w"> </span><span class="n">The</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">outputs</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">`</span><span class="n">buildfiles</span><span class="o">`</span><span class="w"> </span><span class="n">operator</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">targets</span><span class="w"> </span><span class="n">corresponding</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">all</span><span class="w"> </span><span class="n">packages</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="p">.</span><span class="o">`</span><span class="n">bzl</span><span class="o">`</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">files</span><span class="w"> </span><span class="n">needed</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="n">input</span><span class="p">.</span><span class="w"> </span><span class="n">However</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">inputs</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">`</span><span class="n">rbuildfiles</span><span class="o">`</span><span class="w"> </span><span class="n">operator</span><span class="w"> </span><span class="n">are</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">not</span><span class="w"> </span><span class="n">those</span><span class="w"> </span><span class="n">targets</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">rather</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="n">fragments</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">correspond</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">those</span><span class="w"> </span><span class="n">targets</span><span class="p">.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">### Package definition files: loadfiles
</span></span></span></code></pre></div><p>expr ::= loadfiles({{ &lsquo;<var>&rsquo; }}expr{{ &lsquo;</var>&rsquo; }})</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">The `loadfiles({{ &#39;&lt;var&gt;&#39; }}x{{ &#39;&lt;/var&gt;&#39; }})` operator returns the set of
</span></span><span class="line"><span class="cl">Starlark files that are needed to load the packages of each target in
</span></span><span class="line"><span class="cl">set {{ &#39;&lt;var&gt;&#39; }}x{{ &#39;&lt;/var&gt;&#39; }}. In other words, for each package, it returns the
</span></span><span class="line"><span class="cl">.bzl files that are referenced from its `BUILD` files.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Warning: Bazel pretends each of these .bzl files has a corresponding target
</span></span><span class="line"><span class="cl">(for example, file `a/b.bzl` =&gt; target `//a:b.bzl`), but this isn&#39;t
</span></span><span class="line"><span class="cl">necessarily the case. Therefore, `loadfiles` doesn&#39;t compose well with other query
</span></span><span class="line"><span class="cl">operators and its results can be misleading when formatted in a structured way, such as
</span></span><span class="line"><span class="cl">[`--output=xml`](#xml).
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">## Output formats
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">`bazel query` generates a graph.
</span></span><span class="line"><span class="cl">You specify the content, format, and ordering by which
</span></span><span class="line"><span class="cl">`bazel query` presents this graph
</span></span><span class="line"><span class="cl">by means of the `--output` command-line option.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">When running with [Sky Query](#sky-query), only output formats that are compatible with
</span></span><span class="line"><span class="cl">unordered output are allowed. Specifically, `graph`, `minrank`, and
</span></span><span class="line"><span class="cl">`maxrank` output formats are forbidden.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Some of the output formats accept additional options. The name of
</span></span><span class="line"><span class="cl">each output option is prefixed with the output format to which it
</span></span><span class="line"><span class="cl">applies, so `--graph:factored` applies only
</span></span><span class="line"><span class="cl">when `--output=graph` is being used; it has no effect if
</span></span><span class="line"><span class="cl">an output format other than `graph` is used. Similarly,
</span></span><span class="line"><span class="cl">`--xml:line_numbers` applies only when `--output=xml`
</span></span><span class="line"><span class="cl">is being used.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">### On the ordering of results
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Although query expressions always follow the &#34;[law of
</span></span><span class="line"><span class="cl">conservation of graph order](#graph-order)&#34;, _presenting_ the results may be done
</span></span><span class="line"><span class="cl">in either a dependency-ordered or unordered manner. This does **not**
</span></span><span class="line"><span class="cl">influence the targets in the result set or how the query is computed. It only
</span></span><span class="line"><span class="cl">affects how the results are printed to stdout. Moreover, nodes that are
</span></span><span class="line"><span class="cl">equivalent in the dependency order may or may not be ordered alphabetically.
</span></span><span class="line"><span class="cl">The `--order_output` flag can be used to control this behavior.
</span></span><span class="line"><span class="cl">(The `--[no]order_results` flag has a subset of the functionality
</span></span><span class="line"><span class="cl">of the `--order_output` flag and is deprecated.)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">The default value of this flag is `auto`, which prints results in **lexicographical
</span></span><span class="line"><span class="cl">order**. However, when `somepath(a,b)` is used, the results will be printed in
</span></span><span class="line"><span class="cl">`deps` order instead.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">When this flag is `no` and `--output` is one of
</span></span><span class="line"><span class="cl">`build`, `label`, `label_kind`, `location`, `package`, `proto`, or
</span></span><span class="line"><span class="cl">`xml`, the outputs will be printed in arbitrary order. **This is
</span></span><span class="line"><span class="cl">generally the fastest option**. It is not supported though when
</span></span><span class="line"><span class="cl">`--output` is one of `graph`, `minrank` or
</span></span><span class="line"><span class="cl">`maxrank`: with these formats, Bazel always prints results
</span></span><span class="line"><span class="cl">ordered by the dependency order or rank.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">When this flag is `deps`, Bazel prints results in some topological orderthat is,
</span></span><span class="line"><span class="cl">dependents first and dependencies after. However, nodes that are unordered by the
</span></span><span class="line"><span class="cl">dependency order (because there is no path from either one to the other) may be
</span></span><span class="line"><span class="cl">printed in any order.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">When this flag is `full`, Bazel prints nodes in a fully deterministic (total) order.
</span></span><span class="line"><span class="cl">First, all nodes are sorted alphabetically. Then, each node in the list is used as the start of a
</span></span><span class="line"><span class="cl">post-order depth-first search in which outgoing edges to unvisited nodes are traversed in
</span></span><span class="line"><span class="cl">alphabetical order of the successor nodes. Finally, nodes are printed in the reverse of the order
</span></span><span class="line"><span class="cl">in which they were visited.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Printing nodes in this order may be slower, so it should be used only when determinism is
</span></span><span class="line"><span class="cl">important.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">### Print the source form of targets as they would appear in BUILD
</span></span></code></pre></div><p>&ndash;output build</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">With this option, the representation of each target is as if it were
</span></span><span class="line"><span class="cl">hand-written in the BUILD language. All variables and function calls
</span></span><span class="line"><span class="cl">(such as glob, macros) are expanded, which is useful for seeing the effect
</span></span><span class="line"><span class="cl">of Starlark macros. Additionally, each effective rule reports a
</span></span><span class="line"><span class="cl">`generator_name` and/or `generator_function`) value,
</span></span><span class="line"><span class="cl">giving the name of the macro that was evaluated to produce the effective rule.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Although the output uses the same syntax as `BUILD` files, it is not
</span></span><span class="line"><span class="cl">guaranteed to produce a valid `BUILD` file.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">### Print the label of each target
</span></span></code></pre></div><p>&ndash;output label</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">With this option, the set of names (or _labels_) of each target
</span></span><span class="line"><span class="cl">in the resulting graph is printed, one label per line, in
</span></span><span class="line"><span class="cl">topological order (unless `--noorder_results` is specified, see
</span></span><span class="line"><span class="cl">[notes on the ordering of results](#result-order)).
</span></span><span class="line"><span class="cl">(A topological ordering is one in which a graph
</span></span><span class="line"><span class="cl">node appears earlier than all of its successors.)  Of course there
</span></span><span class="line"><span class="cl">are many possible topological orderings of a graph (_reverse
</span></span><span class="line"><span class="cl">postorder_ is just one); which one is chosen is not specified.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">When printing the output of a `somepath` query, the order
</span></span><span class="line"><span class="cl">in which the nodes are printed is the order of the path.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Caveat: in some corner cases, there may be two distinct targets with
</span></span><span class="line"><span class="cl">the same label; for example, a `sh_binary` rule and its
</span></span><span class="line"><span class="cl">sole (implicit) `srcs` file may both be called
</span></span><span class="line"><span class="cl">`foo.sh`. If the result of a query contains both of
</span></span><span class="line"><span class="cl">these targets, the output (in `label` format) will appear
</span></span><span class="line"><span class="cl">to contain a duplicate. When using the `label_kind` (see
</span></span><span class="line"><span class="cl">below) format, the distinction becomes clear: the two targets have
</span></span><span class="line"><span class="cl">the same name, but one has kind `sh_binary rule` and the
</span></span><span class="line"><span class="cl">other kind `source file`.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">### Print the label and kind of each target
</span></span></code></pre></div><p>&ndash;output label_kind</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">Like `label`, this output format prints the labels of
</span></span><span class="line"><span class="cl">each target in the resulting graph, in topological order, but it
</span></span><span class="line"><span class="cl">additionally precedes the label by the [_kind_](#kind) of the target.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">### Print targets in protocol buffer format
</span></span></code></pre></div><p>&ndash;output proto</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">Prints the query output as a
</span></span><span class="line"><span class="cl">[`QueryResult`](https://github.com/bazelbuild/bazel/blob/master/src/main/protobuf/build.proto)
</span></span><span class="line"><span class="cl">protocol buffer.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">### Print targets in length-delimited protocol buffer format
</span></span></code></pre></div><p>&ndash;output streamed_proto</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">Prints a
</span></span><span class="line"><span class="cl">[length-delimited](https://protobuf.dev/programming-guides/encoding/#size-limit)
</span></span><span class="line"><span class="cl">stream of
</span></span><span class="line"><span class="cl">[`Target`](https://github.com/bazelbuild/bazel/blob/master/src/main/protobuf/build.proto)
</span></span><span class="line"><span class="cl">protocol buffers. This is useful to _(i)_ get around
</span></span><span class="line"><span class="cl">[size limitations](https://protobuf.dev/programming-guides/encoding/#size-limit)
</span></span><span class="line"><span class="cl">of protocol buffers when there are too many targets to fit in a single
</span></span><span class="line"><span class="cl">`QueryResult` or _(ii)_ to start processing while Bazel is still outputting.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">### Print targets in text proto format
</span></span></code></pre></div><p>&ndash;output textproto</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">Similar to `--output proto`, prints the
</span></span><span class="line"><span class="cl">[`QueryResult`](https://github.com/bazelbuild/bazel/blob/master/src/main/protobuf/build.proto)
</span></span><span class="line"><span class="cl">protocol buffer but in
</span></span><span class="line"><span class="cl">[text format](https://protobuf.dev/reference/protobuf/textformat-spec/).
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">### Print targets in ndjson format
</span></span></code></pre></div><p>&ndash;output streamed_jsonproto</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">Similar to `--output streamed_proto`, prints a stream of
</span></span><span class="line"><span class="cl">[`Target`](https://github.com/bazelbuild/bazel/blob/master/src/main/protobuf/build.proto)
</span></span><span class="line"><span class="cl">protocol buffers but in [ndjson](https://github.com/ndjson/ndjson-spec) format.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">### Print the label of each target, in rank order
</span></span></code></pre></div><p>&ndash;output minrank &ndash;output maxrank</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">Like `label`, the `minrank`
</span></span><span class="line"><span class="cl">and `maxrank` output formats print the labels of each
</span></span><span class="line"><span class="cl">target in the resulting graph, but instead of appearing in
</span></span><span class="line"><span class="cl">topological order, they appear in rank order, preceded by their
</span></span><span class="line"><span class="cl">rank number. These are unaffected by the result ordering
</span></span><span class="line"><span class="cl">`--[no]order_results` flag (see [notes on
</span></span><span class="line"><span class="cl">the ordering of results](#result-order)).
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">There are two variants of this format: `minrank` ranks
</span></span><span class="line"><span class="cl">each node by the length of the shortest path from a root node to it.
</span></span><span class="line"><span class="cl">&#34;Root&#34; nodes (those which have no incoming edges) are of rank 0,
</span></span><span class="line"><span class="cl">their successors are of rank 1, etc. (As always, edges point from a
</span></span><span class="line"><span class="cl">target to its prerequisites: the targets it depends upon.)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">`maxrank` ranks each node by the length of the longest
</span></span><span class="line"><span class="cl">path from a root node to it. Again, &#34;roots&#34; have rank 0, all other
</span></span><span class="line"><span class="cl">nodes have a rank which is one greater than the maximum rank of all
</span></span><span class="line"><span class="cl">their predecessors.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">All nodes in a cycle are considered of equal rank. (Most graphs are
</span></span><span class="line"><span class="cl">acyclic, but cycles do occur
</span></span><span class="line"><span class="cl">simply because `BUILD` files contain erroneous cycles.)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">These output formats are useful for discovering how deep a graph is.
</span></span><span class="line"><span class="cl">If used for the result of a `deps(x)`, `rdeps(x)`,
</span></span><span class="line"><span class="cl">or `allpaths` query, then the rank number is equal to the
</span></span><span class="line"><span class="cl">length of the shortest (with `minrank`) or longest
</span></span><span class="line"><span class="cl">(with `maxrank`) path from `x` to a node in
</span></span><span class="line"><span class="cl">that rank. `maxrank` can be used to determine the
</span></span><span class="line"><span class="cl">longest sequence of build steps required to build a target.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Note: The ranked output of a `somepath` query is
</span></span><span class="line"><span class="cl">basically meaningless because `somepath` doesn&#39;t
</span></span><span class="line"><span class="cl">guarantee to return either a shortest or a longest path, and it may
</span></span><span class="line"><span class="cl">include &#34;transitive&#34; edges from one path node to another that are
</span></span><span class="line"><span class="cl">not direct edges in original graph.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">For example, the graph on the left yields the outputs on the right
</span></span><span class="line"><span class="cl">when `--output minrank` and `--output maxrank`
</span></span><span class="line"><span class="cl">are specified, respectively.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&lt;table&gt;
</span></span><span class="line"><span class="cl">  &lt;tr&gt;
</span></span><span class="line"><span class="cl">    &lt;td&gt;&lt;img src=&#34;/docs/images/out-ranked.svg&#34; alt=&#34;Out ranked&#34;&gt;
</span></span><span class="line"><span class="cl">    &lt;/td&gt;
</span></span><span class="line"><span class="cl">    &lt;td&gt;
</span></span><span class="line"><span class="cl">      &lt;pre&gt;
</span></span><span class="line"><span class="cl">      minrank
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      0 //c:c
</span></span><span class="line"><span class="cl">      1 //b:b
</span></span><span class="line"><span class="cl">      1 //a:a
</span></span><span class="line"><span class="cl">      2 //b:b.cc
</span></span><span class="line"><span class="cl">      2 //a:a.cc
</span></span><span class="line"><span class="cl">      &lt;/pre&gt;
</span></span><span class="line"><span class="cl">    &lt;/td&gt;
</span></span><span class="line"><span class="cl">    &lt;td&gt;
</span></span><span class="line"><span class="cl">      &lt;pre&gt;
</span></span><span class="line"><span class="cl">      maxrank
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      0 //c:c
</span></span><span class="line"><span class="cl">      1 //b:b
</span></span><span class="line"><span class="cl">      2 //a:a
</span></span><span class="line"><span class="cl">      2 //b:b.cc
</span></span><span class="line"><span class="cl">      3 //a:a.cc
</span></span><span class="line"><span class="cl">      &lt;/pre&gt;
</span></span><span class="line"><span class="cl">    &lt;/td&gt;
</span></span><span class="line"><span class="cl">  &lt;/tr&gt;
</span></span><span class="line"><span class="cl">&lt;/table&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">### Print the location of each target
</span></span></code></pre></div><p>&ndash;output location</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">Like `label_kind`, this option prints out, for each
</span></span><span class="line"><span class="cl">target in the result, the target&#39;s kind and label, but it is
</span></span><span class="line"><span class="cl">prefixed by a string describing the location of that target, as a
</span></span><span class="line"><span class="cl">filename and line number. The format resembles the output of
</span></span><span class="line"><span class="cl">`grep`. Thus, tools that can parse the latter (such as Emacs
</span></span><span class="line"><span class="cl">or vi) can also use the query output to step through a series of
</span></span><span class="line"><span class="cl">matches, allowing the Bazel query tool to be used as a
</span></span><span class="line"><span class="cl">dependency-graph-aware &#34;grep for BUILD files&#34;.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">The location information varies by target kind (see the [kind](#kind) operator). For rules, the
</span></span><span class="line"><span class="cl">location of the rule&#39;s declaration within the `BUILD` file is printed.
</span></span><span class="line"><span class="cl">For source files, the location of line 1 of the actual file is
</span></span><span class="line"><span class="cl">printed. For a generated file, the location of the rule that
</span></span><span class="line"><span class="cl">generates it is printed. (The query tool does not have sufficient
</span></span><span class="line"><span class="cl">information to find the actual location of the generated file, and
</span></span><span class="line"><span class="cl">in any case, it might not exist if a build has not yet been performed.)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">### Print the set of packages
</span></span></code></pre></div><p>This option prints the name of all packages to which
some target in the result set belongs. The names are printed in
lexicographical order; duplicates are excluded. Formally, this
is a <em>projection</em> from the set of labels (package, target) onto
packages.</p>
<p>Packages in external repositories are formatted as
<code>@repo//foo/bar</code> while packages in the main repository are
formatted as <code>foo/bar</code>.</p>
<p>In conjunction with the <code>deps(...)</code> query, this output
option can be used to find the set of packages that must be checked
out in order to build a given set of targets.</p>
<h3 id="display-a-graph-of-the-result">Display a graph of the result</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">This option causes the query result to be printed as a directed
</span></span><span class="line"><span class="cl">graph in the popular AT&amp;amp;T GraphViz format. Typically the
</span></span><span class="line"><span class="cl">result is saved to a file, such as `.png` or `.svg`.
</span></span><span class="line"><span class="cl">(If the `dot` program is not installed on your workstation, you
</span></span><span class="line"><span class="cl">can install it using the command `sudo apt-get install graphviz`.)
</span></span><span class="line"><span class="cl">See the example section below for a sample invocation.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">This output format is particularly useful for `allpaths`,
</span></span><span class="line"><span class="cl">`deps`, or `rdeps` queries, where the result
</span></span><span class="line"><span class="cl">includes a _set of paths_ that cannot be easily visualized when
</span></span><span class="line"><span class="cl">rendered in a linear form, such as with `--output label`.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">By default, the graph is rendered in a _factored_ form. That is,
</span></span><span class="line"><span class="cl">topologically-equivalent nodes are merged together into a single
</span></span><span class="line"><span class="cl">node with multiple labels. This makes the graph more compact
</span></span><span class="line"><span class="cl">and readable, because typical result graphs contain highly
</span></span><span class="line"><span class="cl">repetitive patterns. For example, a `java_library` rule
</span></span><span class="line"><span class="cl">may depend on hundreds of Java source files all generated by the
</span></span><span class="line"><span class="cl">same `genrule`; in the factored graph, all these files
</span></span><span class="line"><span class="cl">are represented by a single node. This behavior may be disabled
</span></span><span class="line"><span class="cl">with the `--nograph:factored` option.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">#### `--graph:node_limit {{ &#39;&lt;var&gt;&#39; }}n{{ &#39;&lt;/var&gt;&#39; }}`
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">The option specifies the maximum length of the label string for a
</span></span><span class="line"><span class="cl">graph node in the output. Longer labels will be truncated; -1
</span></span><span class="line"><span class="cl">disables truncation. Due to the factored form in which graphs are
</span></span><span class="line"><span class="cl">usually printed, the node labels may be very long. GraphViz cannot
</span></span><span class="line"><span class="cl">handle labels exceeding 1024 characters, which is the default value
</span></span><span class="line"><span class="cl">of this option. This option has no effect unless
</span></span><span class="line"><span class="cl">`--output=graph` is being used.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">#### `--[no]graph:factored`
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">By default, graphs are displayed in factored form, as explained
</span></span><span class="line"><span class="cl">[above](#output-graph).
</span></span><span class="line"><span class="cl">When `--nograph:factored` is specified, graphs are
</span></span><span class="line"><span class="cl">printed without factoring. This makes visualization using GraphViz
</span></span><span class="line"><span class="cl">impractical, but the simpler format may ease processing by other
</span></span><span class="line"><span class="cl">tools (such as grep). This option has no effect
</span></span><span class="line"><span class="cl">unless `--output=graph` is being used.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">### XML
</span></span></code></pre></div><p>This option causes the resulting targets to be printed in an XML
form. The output starts with an XML header such as this</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">  &lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;
</span></span><span class="line"><span class="cl">  &lt;query version=&#34;2&#34;&gt;
</span></span></code></pre></div><!-- The docs should continue to document version 2 into perpetuity,
     even if we add new formats, to handle clients synced to old CLs. -->
<p>and then continues with an XML element for each target
in the result graph, in topological order (unless
<a href="#result-order">unordered results</a> are requested),
and then finishes with a terminating</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">&lt;/query&gt;
</span></span></code></pre></div><p>Simple entries are emitted for targets of <code>file</code> kind:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">  &lt;source-file name=&#39;//foo:foo_main.cc&#39; .../&gt;
</span></span><span class="line"><span class="cl">  &lt;generated-file name=&#39;//foo:libfoo.so&#39; .../&gt;
</span></span></code></pre></div><p>But for rules, the XML is structured and contains definitions of all
the attributes of the rule, including those whose value was not
explicitly specified in the rule&rsquo;s <code>BUILD</code> file.</p>
<p>Additionally, the result includes <code>rule-input</code> and
<code>rule-output</code> elements so that the topology of the
dependency graph can be reconstructed without having to know that,
for example, the elements of the <code>srcs</code> attribute are
forward dependencies (prerequisites) and the contents of the
<code>outs</code> attribute are backward dependencies (consumers).</p>
<p><code>rule-input</code> elements for <a href="#implicit_deps">implicit dependencies</a> are suppressed if
<code>--noimplicit_deps</code> is specified.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">  &lt;rule class=&#39;cc_binary rule&#39; name=&#39;//foo:foo&#39; ...&gt;
</span></span><span class="line"><span class="cl">    &lt;list name=&#39;srcs&#39;&gt;
</span></span><span class="line"><span class="cl">      &lt;label value=&#39;//foo:foo_main.cc&#39;/&gt;
</span></span><span class="line"><span class="cl">      &lt;label value=&#39;//foo:bar.cc&#39;/&gt;
</span></span><span class="line"><span class="cl">      ...
</span></span><span class="line"><span class="cl">    &lt;/list&gt;
</span></span><span class="line"><span class="cl">    &lt;list name=&#39;deps&#39;&gt;
</span></span><span class="line"><span class="cl">      &lt;label value=&#39;//common:common&#39;/&gt;
</span></span><span class="line"><span class="cl">      &lt;label value=&#39;//collections:collections&#39;/&gt;
</span></span><span class="line"><span class="cl">      ...
</span></span><span class="line"><span class="cl">    &lt;/list&gt;
</span></span><span class="line"><span class="cl">    &lt;list name=&#39;data&#39;&gt;
</span></span><span class="line"><span class="cl">      ...
</span></span><span class="line"><span class="cl">    &lt;/list&gt;
</span></span><span class="line"><span class="cl">    &lt;int name=&#39;linkstatic&#39; value=&#39;0&#39;/&gt;
</span></span><span class="line"><span class="cl">    &lt;int name=&#39;linkshared&#39; value=&#39;0&#39;/&gt;
</span></span><span class="line"><span class="cl">    &lt;list name=&#39;licenses&#39;/&gt;
</span></span><span class="line"><span class="cl">    &lt;list name=&#39;distribs&#39;&gt;
</span></span><span class="line"><span class="cl">      &lt;distribution value=&#34;INTERNAL&#34; /&gt;
</span></span><span class="line"><span class="cl">    &lt;/list&gt;
</span></span><span class="line"><span class="cl">    &lt;rule-input name=&#34;//common:common&#34; /&gt;
</span></span><span class="line"><span class="cl">    &lt;rule-input name=&#34;//collections:collections&#34; /&gt;
</span></span><span class="line"><span class="cl">    &lt;rule-input name=&#34;//foo:foo_main.cc&#34; /&gt;
</span></span><span class="line"><span class="cl">    &lt;rule-input name=&#34;//foo:bar.cc&#34; /&gt;
</span></span><span class="line"><span class="cl">    ...
</span></span><span class="line"><span class="cl">  &lt;/rule&gt;
</span></span></code></pre></div><p>Every XML element for a target contains a <code>name</code>
attribute, whose value is the target&rsquo;s label, and
a <code>location</code> attribute, whose value is the target&rsquo;s
location as printed by the <a href="#print-target-location"><code>--output location</code></a>.</p>
<h4 id="--noxmlline_numbers"><code>--[no]xml:line_numbers</code></h4>
<p>By default, the locations displayed in the XML output contain line numbers.
When <code>--noxml:line_numbers</code> is specified, line numbers are not printed.</p>
<h4 id="--noxmldefault_values"><code>--[no]xml:default_values</code></h4>
<p>By default, XML output does not include rule attribute whose value
is the default value for that kind of attribute (for example, if it
were not specified in the <code>BUILD</code> file, or the default value was
provided explicitly). This option causes such attribute values to
be included in the XML output.</p>
<h3 id="regular-expressions">Regular expressions</h3>
<p>Regular expressions in the query language use the Java regex library, so you can use the
full syntax for
<a href="https://docs.oracle.com/javase/8/docs/api/java/util/regex/Pattern.html"><code>java.util.regex.Pattern</code></a>.</p>
<h3 id="querying-with-external-repositories">Querying with external repositories</h3>
<p>If the build depends on rules from <a href="/external/overview/">external repositories</a>
then query results will include these dependencies. For
example, if <code>//foo:bar</code> depends on <code>@other-repo//baz:lib</code>, then
<code>bazel query 'deps(//foo:bar)'</code> will list <code>@other-repo//baz:lib</code> as a
dependency.</p>

	
</div>


          </main>
        </div>
      </div>
      <footer class="td-footer row d-print-none">
  <div class="container-fluid">
    <div class="row mx-md-2">
      <div class="td-footer__left col-6 col-sm-4 order-sm-1">
        
      </div><div class="td-footer__right col-6 col-sm-4 order-sm-3">
        
      </div><div class="td-footer__center col-12 col-sm-4 py-2 order-sm-2">
        
      </div>
    </div>
  </div>
</footer>

    </div>
    
      <link rel="stylesheet" href="/css/katex.css" integrity="sha512-G&#43;oCKKieQtUzWNhprOMa35XKURS9yhyKtbm9/m0OOUykuK3/U6dKkqJIxGOoQh/T3MibO5FL8xd2QNhZd/wILA==" crossorigin="anonymous">
    
      <script defer src="/js/katex.js" integrity="sha512-WTufh9t&#43;K&#43;EFkEnso/VDkXWdyfw3x8Z7YoAX42Ec76nwKKkWT/2F57jYrEYwLYMj2hRm9i3W5LAxxd5Z1r6szg==" crossorigin="anonymous" ></script>
    
      <script defer src="/js/mhchem.js" integrity="sha512-VqgbnCOxfd22h/EoEuK6W8DhX3hATOAogWFE/eE4XVBVNg5uaWIocSccsU8FNeYDNpfcIKWy6xz3woYgsWdPxA==" crossorigin="anonymous" ></script>
    
      <script defer src="/js/auto-render.js" integrity="sha512-4bQtxbbsOaDcbu2OFUKZhKrd0X9F2cyGnIt84nVL3K1XpzeiZBzyEepWhMAb3ZUDylETFkLzgZoV8ZpTLIncow==" crossorigin="anonymous"
onload='renderMathInElement(document.body, null);'>
</script>
    <script src="/js/main.js"></script>
<script defer src="/js/click-to-copy.js" crossorigin="anonymous"></script>
<script src='/js/tabpane-persist.js'></script>

  </body>
</html>